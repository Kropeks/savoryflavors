-- phpMyAdmin SQL Dump
-- version 5.2.1
-- https://www.phpmyadmin.net/
--
-- Host: 127.0.0.1
-- Generation Time: Oct 07, 2025 at 03:23 PM
-- Server version: 10.4.32-MariaDB
-- PHP Version: 8.2.12

SET SQL_MODE = "NO_AUTO_VALUE_ON_ZERO";
START TRANSACTION;
SET time_zone = "+00:00";


/*!40101 SET @OLD_CHARACTER_SET_CLIENT=@@CHARACTER_SET_CLIENT */;
/*!40101 SET @OLD_CHARACTER_SET_RESULTS=@@CHARACTER_SET_RESULTS */;
/*!40101 SET @OLD_COLLATION_CONNECTION=@@COLLATION_CONNECTION */;
/*!40101 SET NAMES utf8mb4 */;

--
-- Database: `savoryflavors`
--

DELIMITER $$
--
-- Procedures
--
CREATE DEFINER=`root`@`localhost` PROCEDURE `add_column_if_not_exists` (IN `db_name` VARCHAR(100), IN `table_name` VARCHAR(100), IN `column_name` VARCHAR(100), IN `column_definition` VARCHAR(1000))   BEGIN
    SET @db = db_name;
    SET @tab = table_name;
    SET @col = column_name;
    SET @def = column_definition;
    
    SET @preparedStatement = (SELECT IF(
        (
            SELECT COUNT(*) FROM INFORMATION_SCHEMA.COLUMNS
            WHERE (TABLE_SCHEMA = @db)
            AND (TABLE_NAME = @tab)
            AND (COLUMN_NAME = @col)
        ) = 0,
        CONCAT('ALTER TABLE ', @tab, ' ADD COLUMN ', @col, ' ', @def, ';'),
        CONCAT('SELECT "Column ', @col, ' already exists" AS message;')
    ));
    
    PREPARE stmt FROM @preparedStatement;
    EXECUTE stmt;
    DEALLOCATE PREPARE stmt;
END$$

CREATE DEFINER=`root`@`localhost` PROCEDURE `add_recipe_ingredient` (IN `p_recipe_id` INT, IN `p_name` VARCHAR(255), IN `p_amount` DECIMAL(10,2), IN `p_unit` VARCHAR(50), IN `p_notes` TEXT, IN `p_position` INT)   BEGIN
    DECLARE v_ingredient_id INT;
    
    -- Check if ingredient exists
    SELECT id INTO v_ingredient_id FROM ingredients WHERE name = p_name LIMIT 1;
    
    -- Insert the recipe ingredient
    INSERT INTO recipe_ingredients (
        recipe_id,
        ingredient_id,
        name,
        amount,
        unit,
        notes,
        `order`,
        position,
        is_optional,
        updated_at
    ) VALUES (
        p_recipe_id,
        v_ingredient_id, -- Can be NULL if ingredient doesn't exist
        p_name,
        p_amount,
        p_unit,
        p_notes,
        p_position, -- Using the same value for both order and position for now
        p_position,
        0, -- is_optional = false
        CURRENT_TIMESTAMP()
    );
END$$

CREATE DEFINER=`root`@`localhost` PROCEDURE `create_recipe` (IN `p_title` VARCHAR(255), IN `p_description` TEXT, IN `p_instructions` TEXT, IN `p_prep_time` INT, IN `p_cook_time` INT, IN `p_servings` INT, IN `p_difficulty` ENUM('EASY','MEDIUM','HARD'), IN `p_category` VARCHAR(100), IN `p_cuisine` VARCHAR(100), IN `p_user_id` INT, OUT `p_recipe_id` INT)   BEGIN
    DECLARE v_recipe_id INT;
    DECLARE v_slug VARCHAR(255);
    
    -- Generate a slug from the title
    SET v_slug = LOWER(REPLACE(REPLACE(REPLACE(p_title, ' ', '-'), '.', ''), ',', ''));
    
    -- Insert the new recipe
    INSERT INTO recipes (
        user_id,
        title,
        slug,
        description,
        prep_time,
        cook_time,
        servings,
        difficulty,
        category,
        cuisine,
        is_public,
        status,
        created_at,
        updated_at
    ) VALUES (
        p_user_id,
        p_title,
        v_slug,
        p_description,
        p_prep_time,
        p_cook_time,
        p_servings,
        p_difficulty,
        p_category,
        p_cuisine,
        0, -- is_public = false
        'DRAFT', -- status
        CURRENT_TIMESTAMP(3),
        CURRENT_TIMESTAMP(3)
    );
    
    -- Get the last insert ID
    SET v_recipe_id = LAST_INSERT_ID();
    
    -- Set the output parameter
    SET p_recipe_id = v_recipe_id;
END$$

--
-- Functions
--
CREATE DEFINER=`root`@`localhost` FUNCTION `calculate_recipe_difficulty` (`p_ingredient_count` INT, `p_step_count` INT, `p_cook_time` INT) RETURNS ENUM('easy','medium','hard') CHARSET utf8mb4 COLLATE utf8mb4_general_ci DETERMINISTIC BEGIN
    DECLARE difficulty_score INT;
    
    -- Calculate difficulty score (higher means more difficult)
    SET difficulty_score = 
        LEAST(10, p_ingredient_count) + 
        LEAST(15, p_step_count) + 
        LEAST(5, p_cook_time / 30);
    
    -- Return difficulty level based on score
    IF difficulty_score < 15 THEN
        RETURN 'easy';
    ELSEIF difficulty_score < 25 THEN
        RETURN 'medium';
    ELSE
        RETURN 'hard';
    END IF;
END$$

DELIMITER ;

-- --------------------------------------------------------

--
-- Table structure for table `accounts`
--

CREATE TABLE `accounts` (
  `id` int(11) NOT NULL,
  `user_id` int(11) NOT NULL,
  `type` varchar(255) NOT NULL,
  `provider` varchar(255) NOT NULL,
  `provider_account_id` varchar(255) NOT NULL,
  `refresh_token` text DEFAULT NULL,
  `access_token` text DEFAULT NULL,
  `expires_at` int(11) DEFAULT NULL,
  `token_type` varchar(255) DEFAULT NULL,
  `scope` varchar(255) DEFAULT NULL,
  `id_token` text DEFAULT NULL,
  `session_state` varchar(255) DEFAULT NULL,
  `created_at` timestamp NOT NULL DEFAULT current_timestamp(),
  `updated_at` timestamp NOT NULL DEFAULT current_timestamp() ON UPDATE current_timestamp()
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;

-- --------------------------------------------------------

--
-- Table structure for table `admin_sessions`
--

CREATE TABLE `admin_sessions` (
  `id` int(11) NOT NULL,
  `user_id` int(11) NOT NULL,
  `session_token` varchar(255) NOT NULL,
  `user_agent` varchar(255) DEFAULT NULL,
  `ip_address` varchar(45) DEFAULT NULL,
  `created_at` timestamp(3) NOT NULL DEFAULT current_timestamp(3),
  `last_used_at` timestamp(3) NOT NULL DEFAULT current_timestamp(3) ON UPDATE current_timestamp(3)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;

--
-- Dumping data for table `admin_sessions`
--

INSERT INTO `admin_sessions` (`id`, `user_id`, `session_token`, `user_agent`, `ip_address`, `created_at`, `last_used_at`) VALUES
(1, 76, '8ff773e9-ed03-444e-8c75-a2719c9280b1', NULL, NULL, '2025-10-06 15:58:13.238', '2025-10-06 16:30:28.936');

-- --------------------------------------------------------

--
-- Table structure for table `admin_settings`
--

CREATE TABLE `admin_settings` (
  `id` int(11) NOT NULL,
  `setting_key` varchar(100) NOT NULL,
  `setting_value` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL CHECK (json_valid(`setting_value`)),
  `description` text DEFAULT NULL,
  `created_at` timestamp NOT NULL DEFAULT current_timestamp(),
  `updated_at` timestamp NOT NULL DEFAULT current_timestamp() ON UPDATE current_timestamp()
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;

--
-- Dumping data for table `admin_settings`
--

INSERT INTO `admin_settings` (`id`, `setting_key`, `setting_value`, `description`, `created_at`, `updated_at`) VALUES
(1, 'site_maintenance', '{\"enabled\": false, \"message\": \"\"}', 'Whether the site is in maintenance mode', '2025-09-29 10:10:41', '2025-09-29 10:10:41'),
(2, 'registration_enabled', 'true', 'Whether new user registration is enabled', '2025-09-29 10:10:41', '2025-09-29 10:10:41'),
(3, 'default_user_role', '\"user\"', 'Default role for new users', '2025-09-29 10:10:41', '2025-09-29 10:10:41'),
(4, 'verification_required', 'false', 'Whether email verification is required', '2025-09-29 10:10:41', '2025-09-29 10:10:41');

-- --------------------------------------------------------

--
-- Table structure for table `audit_logs`
--

CREATE TABLE `audit_logs` (
  `id` int(11) NOT NULL,
  `user_id` int(11) DEFAULT NULL,
  `action` varchar(50) NOT NULL,
  `entity_type` varchar(50) NOT NULL,
  `entity_id` int(11) DEFAULT NULL,
  `old_values` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL CHECK (json_valid(`old_values`)),
  `new_values` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL CHECK (json_valid(`new_values`)),
  `ip_address` varchar(45) DEFAULT NULL,
  `user_agent` text DEFAULT NULL,
  `created_at` timestamp NOT NULL DEFAULT current_timestamp()
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;

--
-- Dumping data for table `audit_logs`
--

INSERT INTO `audit_logs` (`id`, `user_id`, `action`, `entity_type`, `entity_id`, `old_values`, `new_values`, `ip_address`, `user_agent`, `created_at`) VALUES
(1, 76, 'UPDATE_RECIPE_STATUS', 'recipe', 0, NULL, '{\"status\":\"approved\",\"feedback\":\"Recipe approved\"}', NULL, NULL, '2025-10-04 23:11:45'),
(2, 76, 'UPDATE_RECIPE_STATUS', 'recipe', 0, NULL, '{\"status\":\"approved\",\"feedback\":\"Recipe approved\"}', NULL, NULL, '2025-10-04 23:12:36'),
(3, 76, 'UPDATE_RECIPE_STATUS', 'recipe', 0, NULL, '{\"status\":\"approved\",\"feedback\":\"Recipe approved\"}', NULL, NULL, '2025-10-04 23:12:39'),
(4, 76, 'UPDATE_RECIPE_STATUS', 'recipe', 0, NULL, '{\"status\":\"approved\",\"feedback\":\"Recipe approved\"}', NULL, NULL, '2025-10-04 23:12:40'),
(5, 76, 'UPDATE_RECIPE_STATUS', 'recipe', 0, NULL, '{\"status\":\"approved\",\"feedback\":\"Recipe approved\"}', NULL, NULL, '2025-10-04 23:12:41'),
(6, 76, 'UPDATE_RECIPE_STATUS', 'recipe', 0, NULL, '{\"status\":\"approved\",\"feedback\":\"Recipe approved\"}', NULL, NULL, '2025-10-04 23:12:42'),
(7, 76, 'UPDATE_RECIPE_STATUS', 'recipe', 0, NULL, '{\"status\":\"approved\",\"feedback\":\"Recipe approved\"}', NULL, NULL, '2025-10-04 23:12:43'),
(8, 76, 'UPDATE_RECIPE_STATUS', 'recipe', 0, NULL, '{\"status\":\"approved\",\"feedback\":\"Recipe approved\"}', NULL, NULL, '2025-10-04 23:12:44'),
(9, 76, 'UPDATE_RECIPE_STATUS', 'recipe', 6, NULL, '{\"status\":\"approved\",\"feedback\":\"Recipe approved\"}', NULL, NULL, '2025-10-04 23:25:24'),
(10, 76, 'UPDATE_RECIPE_STATUS', 'recipe', 91, NULL, '{\"status\":\"approved\",\"feedback\":\"Recipe approved\"}', NULL, NULL, '2025-10-06 21:00:19'),
(11, 76, 'UPDATE_RECIPE_STATUS', 'recipe', 93, NULL, '{\"status\":\"approved\",\"feedback\":\"Recipe approved\"}', NULL, NULL, '2025-10-07 06:25:53');

-- --------------------------------------------------------

--
-- Table structure for table `categories`
--

CREATE TABLE `categories` (
  `id` int(11) NOT NULL,
  `name` varchar(100) NOT NULL,
  `slug` varchar(100) NOT NULL,
  `description` text DEFAULT NULL,
  `image` varchar(255) DEFAULT NULL,
  `created_at` datetime(3) NOT NULL DEFAULT current_timestamp(3),
  `updated_at` datetime(3) NOT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;

--
-- Dumping data for table `categories`
--

INSERT INTO `categories` (`id`, `name`, `slug`, `description`, `image`, `created_at`, `updated_at`) VALUES
(1, 'Breakfast', 'breakfast', 'Morning meals to start your day right', NULL, '2025-09-28 13:42:04.000', '2025-09-28 13:42:04.000'),
(2, 'Lunch', 'lunch', 'Midday meals for energy', NULL, '2025-09-28 13:42:04.000', '2025-09-28 13:42:04.000'),
(3, 'Dinner', 'dinner', 'Evening meals to enjoy', NULL, '2025-09-28 13:42:04.000', '2025-09-28 13:42:04.000'),
(4, 'Dessert', 'dessert', 'Sweet treats and desserts', NULL, '2025-09-28 13:42:04.000', '2025-09-28 13:42:04.000'),
(5, 'Appetizer', 'appetizer', 'Starters and snacks', NULL, '2025-09-28 13:42:04.000', '2025-09-28 13:42:04.000'),
(6, 'Salad', 'salad', 'Fresh and healthy salads', NULL, '2025-09-28 13:42:04.000', '2025-09-28 13:42:04.000'),
(7, 'Soup', 'soup', 'Warm and comforting soups', NULL, '2025-09-28 13:42:04.000', '2025-09-28 13:42:04.000'),
(8, 'Main Course', 'main-course', 'Hearty main dishes', NULL, '2025-09-28 13:42:04.000', '2025-09-28 13:42:04.000'),
(9, 'Side Dish', 'side-dish', 'Perfect accompaniments', NULL, '2025-09-28 13:42:04.000', '2025-09-28 13:42:04.000'),
(10, 'Beverage', 'beverage', 'Drinks and beverages', NULL, '2025-09-28 13:42:04.000', '2025-09-28 13:42:04.000');

-- --------------------------------------------------------

--
-- Table structure for table `collections`
--

CREATE TABLE `collections` (
  `id` int(11) NOT NULL,
  `user_id` int(11) NOT NULL,
  `name` varchar(255) NOT NULL,
  `description` text DEFAULT NULL,
  `is_public` tinyint(1) NOT NULL DEFAULT 0,
  `cover_image` varchar(255) DEFAULT NULL,
  `created_at` datetime(3) NOT NULL DEFAULT current_timestamp(3),
  `updated_at` datetime(3) NOT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;

-- --------------------------------------------------------

--
-- Table structure for table `collection_recipes`
--

CREATE TABLE `collection_recipes` (
  `collection_id` int(11) NOT NULL,
  `recipe_id` int(11) NOT NULL,
  `added_at` datetime(3) NOT NULL DEFAULT current_timestamp(3),
  `notes` text DEFAULT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;

-- --------------------------------------------------------

--
-- Table structure for table `comments`
--

CREATE TABLE `comments` (
  `id` int(11) NOT NULL,
  `user_id` int(11) NOT NULL,
  `recipe_id` int(11) NOT NULL,
  `parent_id` int(11) DEFAULT NULL COMMENT 'For nested comments',
  `content` text NOT NULL,
  `is_edited` tinyint(1) NOT NULL DEFAULT 0,
  `created_at` datetime(3) NOT NULL DEFAULT current_timestamp(3),
  `updated_at` datetime(3) NOT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;

-- --------------------------------------------------------

--
-- Table structure for table `community_posts`
--

CREATE TABLE `community_posts` (
  `id` bigint(20) UNSIGNED NOT NULL,
  `user_id` int(11) NOT NULL,
  `content` text NOT NULL,
  `image_url` varchar(500) DEFAULT NULL,
  `created_at` timestamp NOT NULL DEFAULT current_timestamp(),
  `updated_at` timestamp NOT NULL DEFAULT current_timestamp() ON UPDATE current_timestamp()
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;

--
-- Dumping data for table `community_posts`
--

INSERT INTO `community_posts` (`id`, `user_id`, `content`, `image_url`, `created_at`, `updated_at`) VALUES
(1, 76, 'Hi', NULL, '2025-10-06 17:19:17', '2025-10-06 17:19:17');

-- --------------------------------------------------------

--
-- Table structure for table `community_post_images`
--

CREATE TABLE `community_post_images` (
  `id` bigint(20) UNSIGNED NOT NULL,
  `post_id` bigint(20) UNSIGNED NOT NULL,
  `mime_type` varchar(100) NOT NULL,
  `image_data` longblob NOT NULL,
  `created_at` timestamp NOT NULL DEFAULT current_timestamp()
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;

--
-- Dumping data for table `community_post_images`
--

INSERT INTO `community_post_images` (`id`, `post_id`, `mime_type`, `image_data`, `created_at`) VALUES
(1, 1, 'image/jpeg', 0xffd8ffe000104a46494600010100000100010000ffdb0084000906071213121513131316161517171a1a191718181b1f211b1f1f1f1a1a1b1e1e1b202128201f1d271e1f1b21312225292b2e2e2e1d1f3338332d38282d2e2b010a0a0a0e0d0e1a10101b2d2620262d2d35302d2e2d2b2d2d372f2d372b312d352d2f2f2d2d2d2f2f2d2b2d302d2d2d2d2b2d2d2f2d2b2d2f2d2d2d2d2d2d2d2dffc000110800e800d903012200021101031101ffc4001c0000020203010100000000000000000000050604070102030008ffc4003f10000201020404040306050205050100000102110321000412310506415113226171328191074252a1b1f01423c1d1e162f115537282a216244392d233ffc4001a010002030101000000000000000000000003040102050006ffc400321100020103030106040602030000000000010200031121041231411351617191f02281a1b10532c1d1e1f114422362c2ffda000c03010002110311003f00b4ef8f4759f96379c6b8bcacd863ca318b6360671d3a65171b2ae30ad8ceac74e9938d80c60e3618e9d3338c8c60633889d338ce3955aca8259828ee48181d5798b2c3ff00901f604ff8c559d57932eb4ddbf28bc2b8f0c2ed6e71cb016d4de823fbe38b73c5006349f998fe9811d5521fed0e3475cf0a634e3318585e77cacc127ea31d4f3ae4c699a846a302d891a9a4786907495872a6310c648c41ca717cbd400d3aa8c0dec4627adefbe0a181e0c0952bc89ac63118df1ec4c89ae9c6231bc623711ced3a149aad46d28a249fd001d493603a938e9d6bc83c7f8c2e5a9ea2353b18a69f88ff00451b93fd48c00e14ccfe67f35473258ff41b0036030be99f7cd566af56dd1166c8bd147a9dc9eb7f48283898a424fc47f21fb38ccaf5b71c71356869f62f8c741995400138908e089184ce199e2dfcc73bf4c33ae682a8fc47a60b4750460f1015f4f6e3993b1ac63950cc0691d46e31d64e1d560c2e224ca54d8c85af1b0df1c9971b6ac5a527427a632ad8e538da71369d3a4e3338e53db1ef10017c75a45e779c60d400493006e491fae17f8b73551a40e93adba0536f99c56dccfce7e21fe63c8fba836fa753ea70b54d42ae064c76868deae4e0779966711e6ea14e747f348dc830a2d373fdb099c63ed12a7e25a63b2efeddf158e678d567260c03e83dbf4c0da74d9d84c9bee70b33547fcc6c3c2682d2a14b85b9f18d5c579d9aa4dd9bd49dbda7fce0166b99eb13681f9e3a26569064d6ada27f98044c0fc3711d3aef3df00ebd38b63a9d3a7e72b535154718925b8bd763f11f90c68d9aabb973f2fed82fc1385970826d32f69207de2075204dbac62457e5e6aa468963d00dcc7a6f11d85b126a53536b4aecac45f718ba739507df6c6d4f8b555d9cdf126a70e653fd0e23d5c8b0fbb27d2f820286049acbd4c974799abafdef5b123f4c32705fb4bccd223f9863a86bff0063f9e116a518e98e45713d921e247f955461b3e73e8be05f6a346a01e2c0b09236fcb6fa61f721c429d650d4d8303b63e3ba6ecb70630c9cbbce15b2c46962a408047e846c463bfe44f11f59d6a15bfea7e93ea3ce66e9d252f51d517bb18f90ee7d05ce298e64e61afc4f3a29520cb96a04b6936d447975374924c05e827ace24271ccbf1008fa9686617491519432330830c45d3df6837189b9acdb6501a7582ad4601a4443f404345c0d87693380d4d43362d0f474810dcf3ef8ef994028d39fcbbff009c06198356a5eca3fa76c73cce65ab5c13edda3fae3ad0d34c6a6b5ac3f3c2a23a45a32267569a827b7957af607dff00ce27646b169773bf4fdf49c29640b557d6c7fe91f97efdb161f2ef0f27cec3ca234fa9ef1d86094d0b35a2f59c22ee327f05e1a296b73f1399bf41daf82738c9c7a71aaaa14584c5772edb8c121ec31e071c262d8d96a62f0779241c68f500df10b339e5405998002e493000ef38aeb98f9e2a569a393302e0d53bff00d83a7b9f977c433051732c88ce6c237f3173951cb7927c4abd29af4ed27a7eb858ce677355c1a9986d2806af0d4f9545be2132c7dfd4f6c0ce53e5f45fe7d768904ea6bc589d47bc8ffededb86e35c6df375bf86cb966a2a48269cea78924c9e96ebef8cfab59aa1214d84d5d369d29d8b0b99c389717672528026373b9f79e98059ae1b513c37a91fcd5d6a666debeb87ae0be32536a7468d35f2e9d4ca1d82dfe28500b1d42f6e9d4e076738154d61aa3850cba55554c280001b924f72779926e70bad6a697178f54a555c8c45fa349445afd4e0865506936f631f5c1ba1ca4a413fc429310b6d9a46f04fddd5bfbcdafc78df053979a52b5124b2ba99b581d8da2448f9f7c0cbabd8033b6ec36220f7a08e85a5a177207cbd0037c01ca6483d6bf4da762dd07d26db98c3453c80552048169bc8f4ff007c4be0cea9a95911d1a752345ed0483f4b1eb7117c5a9d50010243d3b9b98332b958420290413a85c75d81f6c48cbd5a62faa23f1588236bedf43183599ca53586a2cc8a54cd2cc2b1588362c2fa7b4cfbc639f057cab164a94d429104021edd4a989b771a4edf3135bac36e36c0e92016a6c74d48248b319047cf623d3db1c9b855360743c18320ac77882370446e31b6678646950f2b6219775f4f71dbdb11f3b98cd52274577a8826c4c1f431bfae2ca7365321c0b644199ce1ce47c3aa2d6d4677f4fdc6072706a8658d32145cdfa7a0dccff9c1cca71c7d247988ea7591ee20636a59aa248bba1eb3b1ef7c1d6a3ae0c5de8237113ab5083607e718e60882185bfae1a38aa535902a0209246fd6fd2d3d300572fadb68186d5ee33107a363612364f38f49a54e2cae5ce6fa35e98cbe6d75d3dc098643f8a9b6ea7d3df15ce672d171d371fd8e23d2aa4111333be39e987c8c19d4ab9a7f03e57df12cde39c37319102a51d598cb3b00b52de59fb9544795ba4ec6ded88dc15ce606a3613b1efd6719e4ee727a47c3ab055c432b095717907eb871c8700a54dff89cb966a2e501a6658d32d03cd06eb10431dbcd270a3fe538cc7d09dd726ebd3cfc613e4fe5b2c753d946e3fa7b9ebe98b08281602076c6285108a146c31b1c3f469766be33235158d56bf4e93423188c658e3138345ed177c4126f80dcc1cc7472a85aab6ff0a8f89bd00c0ce75e684ca128b0d5b68e8beadfdb150e7f39573150bd4259bb9fd0761e9886a816592916c987f8c732d5ce1b9d280f9698d87ab7e2382dcbdc01eb8f111405100927e2ebb6d005cfb81d70afc2b26cce117e7e9dcfb0c3d732f1c396c9a65b2f3e2550004820a8eba81bc9324fb8c2159ee6d3534f4ec3022df3cf30ea032b41bc8b6a9526ee7d7d3b0c17fb28a195151bccc2aaa830e0434dc95eb103b75f6983cafca88e0abea354ee48ebb9dff67e5873e47e557cb575a8eeac90d00a9d50fd8cc0e9df61b613a95e9321a57b78f7985d4255a6438f4f0319327c169690e2413f15e06fd3f7ed81bc7389252a8950143502b2411b88b9f7dbf2c49e6aa9fc2a332558905f4b376dc8ebd47d462b7e219f5ac25fc4f17cc094dc6e4006768c67a517076916b7586a16a8db99ae3ba14e24a06aaefe526e17606409c41e1158d5cd5043ac2786eeac244bb401da01026d7f28c42e0dc60327815e5a9a081a8cda7af4859b7616dad871e4ce20858a3d35a2b3a4020410c4949dee7ca445b7f48715369b0e78bf9c3d6dce96231cfa4f712e56524f86e2938fba41d24da05ccafbdc7a616a850304a92a64c8983d47c8e2d9ca51d4ab2c4b091789178833d63bef8ad7ed432068574a8a7f95588d636b880c40f620c46f27ae01412a5f6b18bad717da642414ea330f135f4332c47b751f5c08ad965d60a343cc294dc1b813efebd0e36a347c0a9e2280541f37afdd207716d53fe7061324d986714840552d3117b92b3d7e5fdf0c5f6187b5c64cc55c9d5a68f595158415a900f94da4c45a2419161f5c72e1fc483b43d20dd036a2083d001bc476c3d72766129a04abe5fe59575226f373edb83d3be10398f842d17a816b8855d749879bc406e00224031ded208b62c88194379fca09aa90c50f4facebc7f84d13e65f29d2a7541b1316246c7a7a9989df0a19b6294c80ca60fc500cff005c30e4b8954a8a29d6aac69aa920416249b68027cbaa6e6606f04c63ae479511983bbb6999d257b5f7ed20ef1820609c994f89b03d62e72ff06356b278a48904c76001327b4edf3c31e47865247015bce490a0c89806e08f4e9d6f826cf4c7f100c292810295ed2447ac803e7813c160534f1144d4ac4a3755f0f489ff00a4ea71ee062aced53379608b4f1681799b82ba39b1d009bf6bc5fe647d4771856ad9461262c0807e771f962d9e68cc9d75a9232e87a74b569160e0acde2f655923a81bc0c5779c40a0130d6da7dffcfd30ed0a98b44abd2bfc47136e05941591926580d43d22c7fa61a392f9a6a65aa84727b1f51edb1edb611b85679a8d40ea6e371dc1b11f3183d9c4a75975529d42e26c7b9fa62955487cf1f6309a77052df4ef13e9ce1b9d5ad492a2ecca0e2431c51bf655ce86954f06ab42999d47b7e87f2c5e2ad2077df0dd2a97c372221a8a3b0dd783c4d4e3493db1d0e3118345e517f69fc1dce67f884cbd4a7499546a6020b46e609831d0f6c27bd2d116c5e7cf9c1ab9ca57639b634c00c28f86816c41dc79bea4ce295c9658d6acb4c1b1373e837fedf3c2b5b0d78ed0cad8731ab9372429d27cd551fcb51aaf1d2425bfd4d7dba0c6bca147f8ccd3e62b41962141fc3bcfefbe37fb44ce15a796e1e90ace43d413b4eca663a46fdce257d9f660510fa87dd3a7d20a9fe98cbd5b114c9bd89f7fc4d5a0a769b741eff78d9538554534e8d3216a33ff00fd224e982cc7e837c17e0797cd2ea5ac0793e1791e61eb1fd71169e6da956158ac865d3b831d77d85ff76c43e60e73d07c1a2559d89049be91eddfdf19d4453b66f7b9fe20ea1ab52ca0037ebf7813ed0385be6eaa9360a1947fa645cfe5227aa8ef88fcb1cb3469a55fe7537d47cba8dcb0d41c4dadf0d849992713f3153ce52ad573021b4aa9bf55f4beabfa623d2e58a350f862ab1a4c41d3a5410642a92083226048ea6f8656ab5b6b9f94a3d1000641f3cc4fabc31d6a3802c09d4076ebe91eb86de014fc4fe422903cba5a7683378eb0771d8e36cc70ba94dd934b106013a64c0eb68befb461a3957863523a882b4c98048f31ed6dc0db7c08d4350851fd479ea84a57be7a49bc3385b527a8eefa99b449e80282008fa924dcfc8615fed773545a8d2a16351d99c1044a841d47fa8c0f91ed86ee63cbb9a6c036ea4020c5fa4e2a4ff8355afc49d35965a0f12c6e17e2080fa1277ec670e520558eee9ec4cca603b062675e07c14d654351d5294ab3abea058b1330a2223acf4be0df19e2229b52a592ad4cf94b9450c090090a7541044836bec3bce05e4f8b05cd353cc69f0dc95526e2048991b491b8bec4634cc70e5cbd485002d4113686008bc91b8304ed7f96246092d1b20b30b186b8571bb2eb092493a00f281f897519579b40b47bda3f33229afaeb20f35c00a55597a5ceedb4dfa8c47a3c3aa50aefa8175434d5d56090490415631166ff006c73e6be61355ce94502929d28c01866264f66200e87ae22cd912d61b8301203e5e9d469a6a1544c8f5e9ee06e3d70528d5755005c1dc01f5230139778a0632b4f5325ca93a413ea6ded7f4c6f9be676a058365db512604d97dafec6ddce04f49d8ed87deaa2f0a733f1547a541a9852d4c3ad4f2eeb6d3247517bf6c2ad4cf2d44528482880413d7ef11daf7c77e13c653cc5d74f703a8ed8d1528cb55530640a62fe680354fd419fef8605f861c408b0fcbc41d9acc193b39632c64881d876fa60454a87cd16b107d8f4bfa62cce15c0a91a4d52aa8366f0d4c8d6c46953bec18836f5f4c22d7caaf8a698234cc3399817f412460f46a29c08bd511719083b5b053849324031691ee3fc13820797ea3872a01d00cdf7f5007d3dc1ed8199295704a9b4cc0f97eb8619c3023ac5553699a56a868d60e2d7be3e80fb39e60398cb692416a7b7aaf6b6c7e5db143731c1d27b8be0e7d96f30ff000d9805ae223f318a7281e5ee189a5df91e7fccfa510c8918f4e20f8f1b5c309047e5f2c6de3d5fc030c256c7c5106a46f88b3cefce4b96a042c3bd40425c15f524c4181d04de36c57ff67791f16b356680aa64ff00d2b768f9c8fa617799f8d1cd95a86cb4c42afa4feed186ae04c6870d6a8f6d7a6928eb7bbc01de77c0b5353188de8a967df58ab98ccff19c47c52479ea8d23ba83d3d227eb8b533bcb4024d30da88e8047c20cdf69bfce30a3c3b20b4c78d44094326d257782247691f2c17cc731e634a80f330750e82e3eec0f9631b50fda118c4d7146a2db611e33970fcf5779a55096bc4111da00eb803c62a52a1546869793753617b4f6226083da70d797e28a01d3a5b668023a104cee0dcc91b09c4cafca196aca0f85a3d5581026ff0014dcdfae054d825d8dede52eefb1be2168b1cbd51ab33bf880b0532ae048f10107d41b47be1da8d56cb8570a2ad3d435c09649b6a1d63db18e0fc8f4699d6ecc4e989223cbbc111716060ced833c2de85366095518d8c488833a4027ac741fdb17dacee0f4e9e1f288d6af4f3b7fbf9c9cb5699906248907691efdf10f33c41692966691f0a86dac092647a75c2ef3471f5cb03fcad64b1b6ad30481d6fd3b60665ea1cf90a08d2540699daf223b6ffdf126ab58587594a7a4c6e6e216e29c5ab66a05285a6a14c8bc93d8f5fd2f8acb21c49f299bac6ab167d425757c43adefbc9c5cf4f860a54d5557ac1f4d800076c535f683a17365944c017e9ebb7a4e0f452a6f21fada4a545e146245c8eb3e770596401378009603e8627db052ad7ad5c95d0ab4d4bb20172acc079b54085b0f2c46ddb1cf9778a3b8f0ce95a710e4de44ceddfa03ea70652a65d4ff0028af97cd24effec23e98216c9b886bf13a706a55aabea7a6c1ac35811a982854d27e1bb49262c01380fc57255478c95948aa25bdc9bc823ea30edc1b9a91d2905234d3669373a6da609f627eb85fe66aef9ecd2ad265531a7593a6c24dcf43bdf037aaace107224a97c923168238570771448860491a8f63200d44c44b1c77a4428ab4f31495de0c1db4d8dd7ac837eb82fc179733a48634982960643a41befa755e07b61878bf0b35aad45aea0910d448f286800146aa6e093d2e6f6b0b4a82d907339aaa29da7225499ccc1d53a2d1fbbe23d576851681aa00def138b0399f86e5e954d42990ade56a4c2e9658658dcfadc49f5c2a7302252750b4de93699218f662a08dc89d24ee7a460e1481e52bbc35add63272e705ad9a556a8fe15240140997b7fa411a2fdefef8975f8164b30c68514d2689d25c9bd4632cc0f70a586d13046c0600f2d53a86a6ba3e254a4cda2a582e9d46c189996d203796c240933058a8702a94ebd6677a469982a033063600988804c1b4c8c75774a74ac960d17556773738e90065293e59cd1553a42dea1d306fefabd3b4fcf0078be55ab565645dcdd8441237387cadcbf5aaba33547d1003ea006a1d46a1f49df044f005d25a8d2a6817692d26df96debd7098d40fce39f9c294b60fe9296e3f937064cc603e4ab14707166f37f0ea9a7cc075361bed37fef8acf3f44ab6d18d4d2551512c62ba9a6508a8b3e91e54e2ad5b2146a0bb2083077e9d7aec6f6df12bfe3c7b37d315ff00d8df15d5ab2ec603a9d3ef1867ff008466bf1a7d314b118842aa4dcf5cfacad399b82265da9525d5e672a7575d3018fe78b0b8ae4e9ae469a542c168d06acd03726747e8d6f4c2f7da0b2b713cb229d90b92361a9cafb7ddc58ab92a753c6a67a252a7bf4d3a81ff00c8fd0e23f1036242fbf7683d23114839e6ff00c7eb1039373548bbd0424ea4320dae402013b486891df0d3c4b859fe1e69e950448007b6dfbeb80394e51396cc0aa9ab5594a9223706d6dec37c19e65cdb53ca046f8ee27dcf7f638c4aaf4dd80424fef89a41aa31537173ddf3cfa4ad730d2492491b020e19f86f37d5cb516d2c6180f88063aae069e911a6ec0c41f4c474cad234b49315527529f7388d99cbac106349f283f2047a8bc76db0e07cda34fb6a0b349bc3f997302ad3ae1890e60cc90d692a58ee45efb8227ae1932dc2d2b21a84f99e2c5a028fba566c48b11d77df156e5094aa9224060418b9f427fa62c5e175d4d0a88e0411f7b68db7dc0dc06137d5389d48d9c777f7eb167a68e030e87de3c27b8b700f129a2d4aa6990dfcca84c49d80f363af0ee0a8a15283eaa856693c92950082d15048d4354e9306c4c11864e3dcb3fc4e4e9d346d3f09d44198067e474cafa7ca308417fe159ca749aacd31fcfd08905c9940a0991002c334830446f182d0a0ac966997575b583fc3c4b1b24b9b4a605528f02ea4ed6d95a2ff003fa62bce25c132ecad356a212ec143880a6e0898b8bf7edb62c3e23ccc89975acb4d9b52ea820ac089b860181e804493d30a79d67cf537d54e9d16903c459922d2ad7865361816ed8df135c7d61e8ee705ad607bbf695ae6f81d7a26355a0447506d3da3d71de9702cc695734d96893058a8b9f4326f3ec36de70cd4786d2541ac0642e4056690c77303f05bad8e18f3b9e7a8682bd35643a54d3581a83752db586a303f0477c325c9c01f3b4bd98662b54cf1a545410ec9759172a62c48edf31111b1b1ae48e1bfcc96572cc358041bacb44fdde8b20fe2040037099c0d99cfd4a62053a750aa010442d97e1ef07aefed02c8adc5a92d2a651833820295ebbea9f4889eb85aa9ecd6e47ce30ecc5405e4c3195cc28a62a9b4c0bec09b181d04ff009c4c6a4acb0c0303d0ec7d48c2b6673fe280ba42c74e93363fd2f89f478e325434eb80b0b21b693f862f3b6e2301d3eb109cfaf8ccfa9a67e9cf778448e7acc3b573965a0cf51c06a443021957ff00eaab3a7ce002601102e226e2399f801150d614d851852559b5042c012a0cf46903a587a61cf3743f8ad79860d4e24532a74952261a47fb1b8b8c24e6b86353d67f8bf1cd43e65820cee75af500811d074eb879352b52935f047d7c61a9d365aaabeb26357a4326a8a0231b0551a4a821af204b3120def00fadcff2ff00067744355a5119469bde4f6f7bfeb84439d3444051aec075b4dcfbc7e58b6b977329e0d15b825bcd22e4c16131d36bf68c27d933b0ee8f6a1fb2a6427327f0d7467740e09a67cca6c549f30b76befe9e98ebc4722a4183117b753eb817c3e907cc54cc058f2159bc9136eb7ea7e782f98ac9a64b003799fd7124d37057ef32983238cc48e3590d618b6a3680bd3618a879a32e354c40f6c5fb9844a94ce9222f245fd0c462a7e64c843ba804cfa5875c468dfb37b18dadaa21062a729719a996aa8d4cc434136b0363bdbae2f1ff00d53ea3e9fe714053a415cea91066d87bff008ae53d7eadff00e31bcbb4e6d7889b8c1227b3153c4e24a6f2ab4d3ea5cfec62d1a99c197a99bcc3b05a480074205f4a06d4b27e28311d6c2d8aab27507fc4249b134bf2d63fae2d0e64e162ad3cd236cf52e379fe5a08fd2f847f106dafbbc47a665b4e2f442f7dff00f338d5e6451957cd2527a92a4a82be627612b3300c480663a4db09dc438f1cc5177756452c74863b41e83b81627bfb5c7e53315e8d47a4ceba4a40d6c1400ba8dced6b1bfaf783c38a672992815c54260922424c9117bb5c493607a13d514d36dc8b117b83e7d23340eda966b861d3f59c38a135581a1e2c93a98e8bb18d4e00507acec7e117c0ba9c45990cd39691a1f68026c4751b1e87d705f3f913597c65257414f22807cb20022202bc79af6e936c06a15c33eb56bc282584eab904826f1179817bda6fa088369613aa55b3a820f49db2ccccca580b0b91d7db05ea71206b5371aa292e96bf962410a07413f29382d91e5d42ad549b6991064586a9ea2f88193e1dad5abd371a0d4d2543199856bfa4612deac4f94d2a6558da5b5cbe5c2d36d474329041e8418ebdf19cef10cb82cc5925255b6911b8eff2c0be57cd2a659b5becd171b49d43f23fae2bbe2d9a1573b50211e23b0004dd440420c18b9936bdcfc8349c9040f3f7f799ff00e2efaa419cb9b78fd6a950d459d3a869a6c604007f3eb3eff3715cdf854a88405c3ab111d63469f9cb4fcb0b19ce1295ea2d00c2994265e0491ee4ec371bdb783726b81e6fc1ff00dae9f1a9c95137360cc418f8620c19df6dc60cd4ee108191efdf9c3d40a97eec60e208cce5c3d24ac9a45208ba54191a4c2bda01d4af72bd99a36b04cdf1654ac6a53f3808c28ea13793a5a3f10927adc7b60d653394a952ab572faff8552054a550cc1736d36d53009b822c277070138d65e8695ad40b696261623499d84fafd3e92d03de3994162d6bdedef3fdc97c95952c549f29155189ea44696bef60d3f3ebb62c3e19c03c0756550f2d009336bff4fd3d715df2755615e9c41467889bc91f5bc831df1716428379587c00fea08fc8613d564c257a8d4d45b8220be6dc853a74fc4b2995dec0c98fd6f887573a6a53675bb042aac6642cee0efdd64f63df05f991b5e59e7bdbfa7e788d94c8b3e5c0bea16d7698001036dae441c29ff1dcedf038fda2e8cdb0331eb695df2ff305735eab97d341c05f31b004914f4f96757c56b0892d3a71172f98fe6d560daa432822e0dc13d6fb624d4e58a55454543a45312d514ca9967ec6e542907b6d6c2ce53aa2b95d27b7436c69304718c63bba4ed1a90e6f9c9f593f31942efaaa4916b8302fb4fd67da71677076a4343ea60503492c60b2aa291a81da41dec7e722b9e12aa5b4b547a6c6449122c244823d3bf5c5a7cb9c3268d32d4c8254caa9f2f406c2d799c0d9f6158d6a480b73d64fe53a6c69b546b2b18598da64edeb6f9605f30d4258a21067b9b06e8c4750378ef18745a4a881408000007e98a979b19e9d671aa6017b4f703d209b7d301ab47694589699bb6aacd3b72c7318a714331e1a032cacb3bcdc106c034ccd8588231cb9872a3ccf363b46dde7d70078c5652299a94a8d4952c1e9bd456f36fa8586a0649f29f9e3867b8b5214505335a4ea2cb5595a26082080264c9bfcb177a1bcee58c2d3da6f9cfce2966e8ab572a763dbe7863ffd309ff39bea7ffce159999f307418266f87ff00e1aa77ff00c07f6c3f519902806d883a74d1ee4adf315a866c9cc86ee23f7f9e2fd6cc7f380dd6ad357137f8940f6e831f35ad522a023a11fae3e84e5bcc0ab97cbb446956a56bc443a5fd8462bf89292a6dce0fa1fe627a7b7679e84fd47f113fed0f80f9d4adc902e27b9e9eb85aafc0a08a6c34c3193e9b19bee0de67ae2dbe68e166a52214cb8f867bf4fce3089c6739ad915d7c3aca54c4021c8dc8e87dbeb8cda55d97e01ec4d6d3957406d9ebfa4e1c0291a520468746bb9b30d434cf63b309ea3102b70ead45612241d5ad44302648499b80bbcec0fb8c3071354514b4537155f48082eb7d572c7be8690368d86f881cd598f0694069a8d6523a0fbc7d88b7ccfae0e9518103be55956a1bda2bf15e3b5aa2b6a24b7946a50aa24104c8400348b4ee307783350351515e8eab5929999800b6b108bbc69f30237338e3c038407a0fe219a704900c54502c593bc5cc1de31ea3cad532f250eb07ef771b83ef17fd9c30da94da418b9d103506d36f2c7d2357126f032cdac6886df50698117b58409f5db093c9451f3ab518afc42cab0258c6dbc9317f7c48e3b9fac323568540c4a9528e07c49aafd6d169f977bab72c679e9554a820956060f51d47d303a3408a6e6fe9c432d5dcc16ddfe7dd2e5e37c14306b1d01cd80b8b02a6debbc46ff44fe048f4f30174965936526642b948b5c6ab5e626db906cf3e256cba315035020adfe1e97ef023a6f84ccd655e8d4728aca1ecc4a9d320c824892a446f80d1ae69d4b1ee826a7fe4d23489b1bfda2d713e1ace56ba3934f590d4c77202831b7589378188198a45453069332ab6ad3786869311d2c44fa0c33e7d8a65de155753033693a483e502db1998e98ef97cad44ca16a600a853ef2f522c27d0dbe783f6c5ac48eb0dd9f64b8f288c9c4bc2a8c690d02c42b2cf5dbcc316a706e68d793f1b66b4a803fd418f72015befbf53bd4b9fcbd4d4cf53e23bfd48f95c1118ebc338b55a434032b71a4ed06663b1b920f7c5aad3dc3e1e64b207501a5afc2f99573eab4b4857d5fccf348001f881812226d63bd86f82994e64a069153e57d6e8576d89837e841070899ae2aea9482985f0cb54092217cab12bb12034fa19eb8e15a9a2ea5a35dfc433349958b991206ca4831bf9b7111810a4a558a8b136f18a0d3302a1dae3309d7cad2a0b9b4550baf5d43bc12547788eff003384834d699f14fde02446c4136f9db057c702a0159d81aaba48f8c1d4be5208322d3e683fd404cfd2a88cc9a09a560587e2249b0fc236f94f5c5a9d122f9e6308e10f1fb439c2b8b526522c1ef72079b636fa47cfd0e1c72d582525d2cc1d21604ee2ed02f1b8888888f7abb84228ad4cfc47e203b95048fcc0c3c53af51991a955d242f8751403e683720fdd62c48241d8f7be295529a9b371630d677171df2c81c755d541bca8961b13123db0939dca356acfe490ec6949efbcafc97ff13df0d1cb798155a0d255d281622c0aef6fa77f7ec60e4429e97327f3169db7e98502d42db9cdc71e310ed16812aa2c6533cdfc0ead15669803a88bcfbf7ef842ae2a02a21ae660dc75ea22df4c7d05cd391d546a063e53f09fdfb8c53bc468e9569b90601ef87b4d5f69db6972a6b26e2607e5aa1aab41f413ee62f8b9bff4ed6ef4ff00f0fed8acf90f879a95d40133504fc88dfd31f4278b4bf09fcb0db2ef63285cd24503ade7ca2ede6c5c5f65bc45aa53a94c1f3155641feba64b7b7986a1ec314cd7df0e1f675c5fc1ccadc0b86593691f77e6091836a5415bfbb7589e95b253bfefd3eb2f3a99c99336640c3e784be72e062b15aa8c563b411379b771863ce01ad0869a6e0bd3ef0d72b1e866dec31a3525d2caaa00926ddcf5eff3c796767a558adf8e26951b259844ae054fc152c55ab5720a5a49027e11d14773d7e78da9708ad5eb78d59560369f0c30913d0f6b60e70fcd84f180f2bdd88d3258741de3bc7493db12721950a5745cbb12c666e37fdfafb60c6abdb75b27dfc846d9f69369c45234a4158e8a045bd09ea31af2fe6556a786ea40663e191d2258a34f4ea3068f13a2e0b56214a8d209fdfcf0839fe646cc662af809a451a6485db5393e52fda20db7b99c452466259723dfeb03bee0a38b1f7c4e9f6bbc51115282eed2580d80b7cefb7d715ff09c9d50642102030336826de6fe9da706f89708ac673359cb31ee2c08e904d967fae04313e102a5951560e9b91327d2d3ea373ed8d9d30509b47ce02a2d4a5f1750312cce1bcc958d3152b36914c9d54cc0b007602249171fe70fad9ca440a8b76a81481aba46fbc6df5f5c521c5a854cb94a0ee4d46a6a51b441552c748632016808476063ad9ab83f1aaaaab4d5e184794c59474f402fe59ea4fb0eb69112f68b52a8daa2090073c63e936e74cf255a758251f0ea52a834b289904032dd079e47d3be39729bba523abe169281b7b1d4c493d0e9220f70312b24d46a9aef51c82c08d3048f881804ec600f31d8cf6c4fc964daad1745312085044ed78b1db79ff38559c280aa317f7ebccd028a1724e3d9f7c45ee219651e255aa8487265560692de65651b47974efd075c23f19c9d5a2d206aa47e1704107e63aff9c1dcde75f2d4ead120d464662ba8ce95313b8326e2f6b4768c2b351ad5b4ea6251af6fcfea7bfa634a8ecb127d6295cd50c0273dd0cf26bad56601f4bd869ead3611d227bed698186ee25cad5ea3ab1aa4b8d2c5034905448f6217aef81dc23214f2c8a8356b6b965590bf749262c44cef6fd5cb87a51a0c19d810cf22c4853d080644f7eb799ec8d5d4a87c1201e23852aaa026c4f75a2966794ea3bd104e8d32750ea277dbbeaf913f3daa65d172eaa4850f9a6569fc0b2cd27bb427d630cf9dcfd35a8f510485161bf5063d8dff004c70abc251850218a0825826952758bc82762254ce054b53761bf896a89717e2f2b0e1992a92ec835d3a443120ec09b41d8cedd267161d1cc545a695129d3ad4c024845f341110e4926dd08b5a48241c45ce72e2c55fe1730537f129991e5da4aefa4ac99bed8114f299aa242ab280c0c32b6a5fa5880479a48c3cebda80d289f0e2fefdf12c2e01c694555f23e954d3a8d32b3312096de3ac40ed86bff89d17821c49b41b1fa6295c8f1c7575f198951631617ea7a9ef3be1db82f11ca3d40bac123a6aff00b819060f411846b3ba9c0c183aba4561bf37b74cc2fcc7525195ba49178ef8a5798ea92e54fc8ff8c3c7da371da4f4da9ea9064100dfdad8ac782e5cbbda748d81efdbf7df06d152c1a8d0643a85a76e6583f65fc3bf9a5ccff2d245bab4a8f98927fedc58ff00c4fa9fa37ff9c2ff0029e48d0cb826cec4b1b1f6511d2d27feec18fe21ff0017e6d8717be0eb9bb597a4f9bea2e3196ac558106083231d2b09388ec23e58d122e2648363797bf28f1019dc884daa2925237d63e25f9fc5f338ee16b2479b508dc6e40ee2267150728731b652a833e42c09ff00491b30f6ebdc5b177bf134a947f88401923554a620e926e5d06e46c4fbcf7c79fd7e908c8e9f6fe3ed36f4f5cb0f03cf9ff3f795e734e7d96af88ac4762bd0fefa62770ce3c6bd3094aa0a75c4c5e0313d89ba923fc4f46014e86615bca0cc8e8647e7850abcb74e9d61a895512419b18dafd3f2c2f46b5365dad8223fcfc36e219e0959d19ab66a46856856025aa31883d4c7aed688c45adc6a5ccc28bd97658dcc09f9e07f323414756069aa872cc6086d45368ff491d87732319e0d9ecbba5c4826e54f9ad168eab3f43dfa34f459577371e1074de9b313fedc5bf610e56cda37fedd935ea004804e9b5fbf53efbfbe11b8a70d34f30c94fca0ed2605f7049b61eb98f2e4661330103d034c94249004957077f2b020ed7bf7c44a392f16acd486a8ff0008be90b6f335aca3703a9e9d31c8452c0e2d9f381a61db733fca4135f36b2e5d9de9b32bcbccea58201836868b4807a5b1028f1baad502a144d17594604f42874902e09f347cf0ed9ec84546a34ea20a8d4d081b92d326dd7ca6489e8308b98e1d568d764b9757066409f9475f4c192b5f07eb074f4f4d9aebcdb91887386e79892a34d3330d4d754483710c4dcf5126e0c1c1be1dcd9469b0029d63549d282da0b1ec6c3489bb46d8195780ea515fcc4958d28fe6257e464e82bdb638ad6ae72a900b1863611d0758ec4e27b31a820b1c7a4ad4a34e8a32d2e4f3d73d7df58d59ecc0ab9b735181dbc50b2118300c154fc4d623cc42f4816bf7c9f039ac2920d2a4da76008f2de7d47d30228d75f1109dd88245ae003bf6331ed047b5adc332695511a60e90be69005bd6ff003dbdb01d4d434ec178e823548f6681df9ef8b99bf132ac6a169d2ba62773b6c07ce09eddb01eae76b567596a4be212c0bb048024122480aa4f7b9207ccbf3765e6696a90a1aa1066ec3eedbb9fe9f35fe075a8067558665611a8c963b485dc28903fedf5c5b4e14a1aac2f6e07840ea0baedd86c58e4f5f086323c31aa320f165996e56f10de5023e2b0b1f5c1ae31c2eb53a7aa931a8580d350a13a47552820c751b41c02cb661866141683b49034afde1f158c191e8670dd90e7414c69758241d3019a0fa961276ee45c5fa607b431dc71f5c461daa6d1b3e2039e900668c2d1cc5406a012accaa468699f9124cc4de0f78c49e5acfd226a55aa3cc5b61d351513d2d007e73be18f8a046a06bba403e6755bdc491e5eb223e9df0b5c1b24b9b766a29e1a459835a64106458458e937bc8b5f03a75996ec071faf84a7f91459763e3bbe5e322f1ce5ca515190794398216d1b8bee2dfbe9850cc70a646d4da9045b704cf68f4c5ad9ca6d4e8b6abca9951eb663846e355854605802002205afed7edf3be2b46bb133905c1ee88dc429892019fdfbe1b39278482ca185be263ebf84fa74ff006c0bc8e4bc4ac216429da275107638b13294d69ab395124963a445c93b7cb6ec31a5b890160c8db76f487eb3a858ddbb769da3107c1ff42fd70be38978a4c1b032d248b4f4ea6c31d7fe2547f11fa1fef83043dd12b8952d7a77c45a8b833c51021c00ccd79c3d3327366c3efd9ef393e5cf844ccfc326cc3aa926dd67e5f5afa9d3662140926c0608e7786bd31a8ff5c06aaab60c634eccb7602e3acb6f335050ff00dce5c4e5d8cba7fca6f6fc07f29ec703788f144a825585e63aef815c8bce4a9fcaac1658699207997b13d3e8779c14e64e555a6ad98c9f9a83497a6675529fd536f6f6c64d4d2287b9e66d52d486b7777fe8601a741c6a60255ac415041123a7704033bd85ed897cbfc29506aa6d63bc5e3a99b4d8743872e47cbad5caf9947eff0049c44abcbcc95fc4a762c088ee3b1ef8036b882518c28a748be0588eb04f0aa59f72510b0080b6920401b8890609de379ef865e079c4a4957c51e62a598b1963b7537246ff002223b34f2fd365010ac82a7512222e34c0fa8c0ce6be516aeeaf4481f8ae77b4118a6f1572bf97af7c0bea1598a3d8771fde00e54ca543c4eabf8aac148d4c1419103c84d882241b740b20634e7634d33ea6e15f4f9bb1da7d81837c3372d729ae4d430f355281588100c1247ac893ef24e20f3af02350abf4698fc8df05af594360605b36f9457f0f3b6a7c479bf94834f37e0d5607e13e61db50b5bd0827a6c4f6c2c52e054a90ab5ab54a6aa055a8a03a9611f0a8036963ee60fa62c3e07c2c2512ed0485820de226e7a5fb198b5ed8ab39c3220d4a74518bb165d405d7cc42898b6f6fa62748773ed1d63b56a290c472205e0f98f16ab5536691bf49dff7eb8bd394dc55a2a180658243099f97eb8a032f98f0abb5a06b6054f4836fcadf2c5d3f67f598ae907488d43bc19f94e2ff0088210e0db1efbe015b7e9bc441dc732cb4eaee595a549ebbee7a9b8076be0c50a33415d902a9514f588f38b15703a19efdb0d35e852f899818124918f67e807cb90809b020778ed84c2b6c20f494a9ab0e145be72adcf70cad49a9badb513aa6ebaa46e0cefe5bff00518e79de23997a9a5e9288202db50823a4955ffb4c7f5c3d652b8acba08b85820d88ec47cf0279ab35532e69b253d724c955d5063481a62e4b1023dfb62d42b16201507ce4d77b25bf2917e23472e2139644ad4b4d583ae502824992605a2f895c3b8465f2de20a4a06b6d646e01802c3e58e794cc16655234b68591b45a623d36c6f57c41e7562475027f3b6d7c11f5172768ebd220b4f001315f9df888534e9dc493acafe18b8fd308f9eaab52a9d000ee56c6d623fd4627dbd76c17e6ce25e2d72b03cb175bc4741ea6d8c70eca8a6039f8cf9956410a3bbffaa20c7d6d6c4d0a65b335900441798c9e5928aea6b4088fcb6ea4dbebe860952a3e2522f24cf49311ec3108ff0032a2c8d5064c9b6c6ffefdb06c3204842abe8a277efdb6be1e51b7881aae5a273b28241f5bff004c67c45fc4bf43fdf04ea525a93a841d42e2c778b8c72f168ffcf1f4ff00386d6b5845ca5e5539fac49be070524e27668608f01c84f9a01981d7ca499b7a9008eb627ae0ec6c266d342e6d0ef24f2d13fcc29a88dfd0758fdf7c327327091528954516113ed7b7e7893c2b31a1740b2cf9ac0c9db7ed8939acd7887c2a71e6b1f4c20ec4b5e6dd3408bb7a4a573b946a6c476fcb0ddc97cf9572ec16ab16580a0ef0368606ccb16bedd36182bc6f97805302483058759ec7d0e2bfcf6419188ed83dd6a0b3449e9b513b97832f7e155a829f168095a806aa4a447524d3efbed6db0cd572cb5955a8329204699d875046e08da0e3e71e5de64af936f21254ee84d8ff00638b4b80f3ad3a90e8da6a0b936d50040d4b61500123bedef8ccd4e85725873d7df1f68c254ed6db4e7b8fbcfde5954661431820419f438ddb34104dbb7f4c40cbf194aaa2a38001ddd0ea4f991743ff00508f538c667221c8aaa4301d8c823d2f842b2d4a3f973dc6042026cf885a9b82ba9ac4ed88fc4729e200a48b5c4e344a61d74dd62fbfd3fdf1038c719a74c1120802c4fef7c5856ba59c63ee7ae2425362f64e60dcfd444075bc007693e6f73d845f08194e254654856351ea97d2b3258799222f61aafb4289898c7b9b38c7f109a50c90a4c2dfd4927b01f97be16f95b3094dd99c6b27cb720883b9604f98080636307d30f7e1f4f6296e237ac57a74ec05cf591b9b72ccb575301aeaea723b4df79fa75813f78619b90f9c7c23a596fe504cfaee7d3fbe17b8ed4a5559dd18cb303a5a7545ec204002f791b8b08c045d54db5afc27d7ea27be1eab416aa6d312d2ea181b30c1e44fa93259da55535283ed89d5dd5527a0c513cadcf0f474ab31d246ff00bfdce1df31cfb42ad134501351d5a0af4b7c4660003727617c662ad45254ae6d82043d6d2edf894dd7ce71e2d5e9d4cd914882894d5d88220cf9ac05cd8fb5fb88c39a5451960c54122e240b09df085c95cba72f43c6ac7ff8e6257a82a0fc84f5dd8d8759f98e622c9a10169b08db7076ddb6e96c02b809576d3cfc36bf4b99d456a574f88707e91a1abd259aae7480bbf79bc47cf093c67992ad69a5481a74a3793a9ad727a28fa9f6e83ab316f35572dd226c36dba7ea711ea666e348023603fa7e77c174fa6c5cc64535a66e727e9356a77fc2a3af71e80811efb9fcf19cc565090a3d00f9e22d5a6e5833cc6e074f51effb18da9d366753d044dbf7db1a01428b0906a16e630f07d034a1b1893f39007e58299a208b7cf01797eecf509f48fd306b385453927a1248991edea7618aca1e62bf1acc8a485949d550e85f4fc447ac75f5c2e7f049dcff00f5c1ae20e2b5766fb94e29a01b48bb9fac0f96257f0fe9f90c141c40b732accd38d5a7ebfdb07784540124160c2f11620f63f2ff006eabf9da052b36ada641ef8cff00186c270dd4527113d3384cc701c509f2a1b9b60ff07ada5616f3b93ed047effc62bba15749277bce0d65f8a1d202cdfa61764b713412a86cb471ce670d58a29066649e83724fa60771ec850a1466cc48124fa81d22413bdff2c72e199b1494b10093724f4f7fa4616789e65f3350c4e807114d6e6c25aad4d8b7301d46d44c0b63092a410483dc60b7f0518d864bd30e84c4c835493792782f38e66810439b75060c7b8dfa6f87ae11f68541879e51cfc4c87c327d48bd373eeb8411c20b898b8b5bfafefa6066772829eeeb3daffdb00a9a5523bbdf7461356dc367efeb2f94e36b5165330bdbf98a50c6e7ce9a94f6d8600e732f9ba81d5514ac91fcb70ee5459b48066fb6c2315265b34e9f0b91e931f960e64f9af30912daa2c350ff006fd9c67bfe1e01dca07d47ef1da5ab45e31f207ed687388f2f66c428ca3850c496b1246c058c003d6f3dba89c9f0ccca542528d5ed3e1b7ce2df9e0be53ed0ea8f8876d89fd04007d705e9fda65e48a9ec1c40f4f87f3b1c4ecaa3047bf58515d79bde2ad4e5bcc556b50a927ba11b40da31c8f2767c82a32ad1dce91f99230ee3ed2d47c29567d596df32b8899afb43d44ff28dfa1727a7a46241ac3f28f5fee55ea0639b45cc9fd9fe70fc6d4a98eb24b11ffd4699ff00bb06b8472d52a321aad4aa598a95550a3a6fd6040fbc07d71c6af3a5620e95a6beb0491d3a981be0466b981ea31d5564c77e9fa0fae2db2b3726de5285900b731df335e9a4063658d379989ea493f4be04d7e396850144efb7b5cdfe918516e22d3b1f7277c7315f543c93dbfdb134f46a9992da9b8b49fc538f3060aab33f788d8131e55ef27ae0952a02ae59d90ba16f8998f998c7a2ac1ecb788c2f0ab59abd32800040592401327bfbe0e7165aa4d0942d4dc9554d4449df51236e847a03df06360001116a9b9cb64dbd333d95d54a8d352c490c64dfadf6ef89f47880150abac8368f4eff005c632d952ca411e6dfe9717b622664eb61a45fafcbd703bdce63a16ca2d0d65b8a8452aab2356f3bf61fe711b3fc77592aa4a85f88ff00aae160f58327fdb023c5288c7ef130a3d4feff002c0b5a9adf4ccaa9bffa8defeb8e54bcea8e17119794b85357aa94813a07998cfddebf326d8b7bf81a7ff2c602f24703fe1e802c22a548661dbb2fcbf5270cb1fb8c68d340a26455aa59b13e7fe2790d24cfc8614b88644a3ca831e9d0ff006c7b1ec59841a9b191dab49c18e1c6209bfeff004c7b1ec2ee311ea0c4b42de03d61130969f97b608370a0a0102dd863d8f60d45005117d4d467a841e9323204c88b8fd44e3d4b2579fdfa6f8f63d82c088472b9030401322009800ffb7fbe3bf1de03a527c3d4c0086e9ea6f3f98c7b1ec4f491d6575c7b26c21ca98d8bea0413120080222f816b23a9c7b1ec2ef83184c89d45461d71d92a377fc863d8f6044c2db33aa557fc5fa63cd5d81f88fb6338f620665ed8bcd093d7eb8ed4d220fec63d8f609d240e675aee00911ea3be3bd1a6de0788e8a94c36983b931261772b1b902c4af7c7b1ec50f10755c870a3ac2b946149a20152371d477076823ae27e5f8b169a4952953650595ea90a077f9c122063d8f601b413986355bb0044df847160b46598d4cc54aa6480485a6b10144004b59bbc15ef8d1d34d60365a835003a6ffbfa6318f62ae2c712fa4b95b93d60ee22f7842488d227bcf98fe9070d5f66dcb01d85771e4436ff0053ff0065fd7db1ec7b0c511c082d4b1c996ca8c67563d8f61b99f3ffd9, '2025-10-06 17:19:17');

-- --------------------------------------------------------

--
-- Table structure for table `community_post_likes`
--

CREATE TABLE `community_post_likes` (
  `id` bigint(20) UNSIGNED NOT NULL,
  `post_id` bigint(20) UNSIGNED NOT NULL,
  `user_id` int(11) NOT NULL,
  `created_at` timestamp NOT NULL DEFAULT current_timestamp()
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;

-- --------------------------------------------------------

--
-- Table structure for table `cuisines`
--

CREATE TABLE `cuisines` (
  `id` int(11) NOT NULL,
  `name` varchar(100) NOT NULL,
  `slug` varchar(100) NOT NULL,
  `description` text DEFAULT NULL,
  `image` varchar(255) DEFAULT NULL,
  `country_code` char(2) DEFAULT NULL,
  `created_at` datetime(3) NOT NULL DEFAULT current_timestamp(3),
  `updated_at` datetime(3) NOT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;

--
-- Dumping data for table `cuisines`
--

INSERT INTO `cuisines` (`id`, `name`, `slug`, `description`, `image`, `country_code`, `created_at`, `updated_at`) VALUES
(1, 'American', 'american', NULL, NULL, 'US', '2025-09-28 13:42:04.000', '2025-09-28 13:42:04.000'),
(2, 'Italian', 'italian', NULL, NULL, 'IT', '2025-09-28 13:42:04.000', '2025-09-28 13:42:04.000'),
(3, 'Mexican', 'mexican', NULL, NULL, 'MX', '2025-09-28 13:42:04.000', '2025-09-28 13:42:04.000'),
(4, 'Chinese', 'chinese', NULL, NULL, 'CN', '2025-09-28 13:42:04.000', '2025-09-28 13:42:04.000'),
(5, 'Indian', 'indian', NULL, NULL, 'IN', '2025-09-28 13:42:04.000', '2025-09-28 13:42:04.000'),
(6, 'Japanese', 'japanese', NULL, NULL, 'JP', '2025-09-28 13:42:04.000', '2025-09-28 13:42:04.000'),
(7, 'Thai', 'thai', NULL, NULL, 'TH', '2025-09-28 13:42:04.000', '2025-09-28 13:42:04.000'),
(8, 'French', 'french', NULL, NULL, 'FR', '2025-09-28 13:42:04.000', '2025-09-28 13:42:04.000'),
(9, 'Mediterranean', 'mediterranean', NULL, NULL, NULL, '2025-09-28 13:42:04.000', '2025-09-28 13:42:04.000'),
(10, 'Middle Eastern', 'middle-eastern', NULL, NULL, NULL, '2025-09-28 13:42:04.000', '2025-09-28 13:42:04.000'),
(11, 'Filipino', '', NULL, NULL, NULL, '2025-10-02 17:37:00.499', '0000-00-00 00:00:00.000');

-- --------------------------------------------------------

--
-- Table structure for table `ingredients`
--

CREATE TABLE `ingredients` (
  `id` int(11) NOT NULL,
  `name` varchar(255) NOT NULL,
  `slug` varchar(255) NOT NULL,
  `description` text DEFAULT NULL,
  `image` varchar(255) DEFAULT NULL,
  `created_at` datetime(3) NOT NULL DEFAULT current_timestamp(3),
  `updated_at` datetime(3) NOT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;

-- --------------------------------------------------------

--
-- Table structure for table `instructions`
--

CREATE TABLE `instructions` (
  `id` int(11) NOT NULL,
  `recipe_id` int(11) NOT NULL,
  `step_number` int(11) NOT NULL,
  `instruction` text NOT NULL,
  `image` varchar(255) DEFAULT NULL,
  `created_at` datetime(3) NOT NULL DEFAULT current_timestamp(3),
  `updated_at` datetime(3) NOT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;

--
-- Dumping data for table `instructions`
--

INSERT INTO `instructions` (`id`, `recipe_id`, `step_number`, `instruction`, `image`, `created_at`, `updated_at`) VALUES
(1, 1, 1, 'Marinate', NULL, '2025-10-05 02:26:48.302', '2025-10-05 02:26:48.302'),
(2, 6, 1, 'Thaw Pork meat', NULL, '2025-10-05 04:17:03.484', '2025-10-05 04:17:03.484'),
(3, 7, 1, 'grill', NULL, '2025-10-05 08:28:48.639', '2025-10-05 08:28:48.639'),
(4, 91, 1, '1. Pre-heat oven to 160°C/140°C fan-forced.', NULL, '2025-10-07 04:59:24.599', '2025-10-07 04:59:24.599'),
(5, 91, 2, '2. Place beef in a bowl with 1 tbs flour. Season, tossing to combine. Heat oil in a deep ovenproof frying pan over medium-high heat. Cook beef, in 2 batches, for 5 minutes, turning occasionally, or until browned. Transfer to a plate.', NULL, '2025-10-07 04:59:24.599', '2025-10-07 04:59:24.599'),
(6, 91, 3, '3. Add onion, thyme and bay leaves to pan. Cook, stirring frequently, for 8 minutes or until onion has softened. Add all-spice and remaining flour, then cook, stirring, for further 1 minute, And sherry (if using), Worcestershire sauce, stock and vinegar, then bring to the boil. Cook for 4 minutes or until reduced slightly. Return beef to pan. Cover, then transfer to the oven and cook for 2½ hours.', NULL, '2025-10-07 04:59:24.599', '2025-10-07 04:59:24.599'),
(7, 91, 4, '4. Preheat grill on high. Arrange baguette slices over beef mixture. Scatter over cheese. Grill for 5 minutes or until golden. Scatter over extra thyme and serve.', NULL, '2025-10-07 04:59:24.599', '2025-10-07 04:59:24.599'),
(8, 93, 1, '1. Heat oil in a large heavy-based saucepan over medium heat. Add onion and cook for 10 minutes or until softened. Add ginger, curry paste, cinnamon and cardamom. Cook, stirring, for 2 minutes or until fragrant.', NULL, '2025-10-07 14:25:13.114', '2025-10-07 14:25:13.114'),
(9, 93, 2, '2. Add pumpkin, tomato and coconut milk. Bring to a simmer and cook, partially covered, for 20 minutes, then add chickpeas. Simmer for a further 12 minutes or until pumpkin is tender. Stir in chopped coriander. Serve with rice, and topped with remaining coriander and chilli.', NULL, '2025-10-07 14:25:13.114', '2025-10-07 14:25:13.114');

-- --------------------------------------------------------

--
-- Table structure for table `meal_plans`
--

CREATE TABLE `meal_plans` (
  `id` int(11) NOT NULL,
  `user_id` int(11) NOT NULL,
  `name` varchar(255) NOT NULL,
  `description` text DEFAULT NULL,
  `start_date` date DEFAULT NULL,
  `end_date` date DEFAULT NULL,
  `is_public` tinyint(1) NOT NULL DEFAULT 0,
  `created_at` datetime(3) NOT NULL DEFAULT current_timestamp(3),
  `updated_at` datetime(3) NOT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;

-- --------------------------------------------------------

--
-- Table structure for table `meal_plan_days`
--

CREATE TABLE `meal_plan_days` (
  `id` int(11) NOT NULL,
  `meal_plan_id` int(11) NOT NULL,
  `day_number` int(11) NOT NULL,
  `date` date DEFAULT NULL,
  `notes` text DEFAULT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;

-- --------------------------------------------------------

--
-- Table structure for table `meal_plan_meals`
--

CREATE TABLE `meal_plan_meals` (
  `id` int(11) NOT NULL,
  `day_id` int(11) NOT NULL,
  `meal_type` enum('BREAKFAST','LUNCH','DINNER','SNACK') NOT NULL,
  `recipe_id` int(11) DEFAULT NULL,
  `custom_meal_name` varchar(255) DEFAULT NULL,
  `custom_meal_description` text DEFAULT NULL,
  `order` int(11) NOT NULL DEFAULT 0,
  `notes` text DEFAULT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;

-- --------------------------------------------------------

--
-- Table structure for table `notifications`
--

CREATE TABLE `notifications` (
  `id` int(11) NOT NULL,
  `user_id` int(11) NOT NULL,
  `type` varchar(50) NOT NULL,
  `title` varchar(255) NOT NULL,
  `message` text NOT NULL,
  `is_read` tinyint(1) NOT NULL DEFAULT 0,
  `related_id` int(11) DEFAULT NULL COMMENT 'ID of the related entity (recipe, comment, etc.)',
  `related_type` varchar(50) DEFAULT NULL COMMENT 'Type of the related entity',
  `created_at` datetime(3) NOT NULL DEFAULT current_timestamp(3)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;

-- --------------------------------------------------------

--
-- Table structure for table `nutritional_info`
--

CREATE TABLE `nutritional_info` (
  `recipe_id` int(11) NOT NULL,
  `calories` decimal(10,2) DEFAULT NULL,
  `protein` decimal(10,2) DEFAULT NULL COMMENT 'in grams',
  `carbs` decimal(10,2) DEFAULT NULL COMMENT 'in grams',
  `fats` decimal(10,2) DEFAULT NULL COMMENT 'in grams',
  `fiber` decimal(10,2) DEFAULT NULL COMMENT 'in grams',
  `sugar` decimal(10,2) DEFAULT NULL COMMENT 'in grams',
  `sodium` decimal(10,2) DEFAULT NULL COMMENT 'in mg',
  `cholesterol` decimal(10,2) DEFAULT NULL COMMENT 'in mg',
  `is_auto_calculated` tinyint(1) NOT NULL DEFAULT 1,
  `updated_at` datetime(3) NOT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;

--
-- Dumping data for table `nutritional_info`
--

INSERT INTO `nutritional_info` (`recipe_id`, `calories`, `protein`, `carbs`, `fats`, `fiber`, `sugar`, `sodium`, `cholesterol`, `is_auto_calculated`, `updated_at`) VALUES
(93, 119.00, 0.00, 0.00, 13.00, 0.00, 0.00, NULL, NULL, 1, '2025-10-07 14:25:13.114');

-- --------------------------------------------------------

--
-- Table structure for table `payments`
--

CREATE TABLE `payments` (
  `id` int(11) NOT NULL,
  `user_id` int(11) NOT NULL,
  `plan_id` int(11) DEFAULT NULL,
  `amount` decimal(10,2) NOT NULL,
  `currency` char(3) NOT NULL DEFAULT 'PHP',
  `payment_intent_id` varchar(255) NOT NULL,
  `status` enum('pending','requires_action','succeeded','failed','canceled') DEFAULT 'pending',
  `payment_method` varchar(50) DEFAULT NULL,
  `error_message` text DEFAULT NULL,
  `metadata` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL CHECK (json_valid(`metadata`)),
  `created_at` timestamp NOT NULL DEFAULT current_timestamp(),
  `updated_at` timestamp NOT NULL DEFAULT current_timestamp() ON UPDATE current_timestamp()
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;

--
-- Dumping data for table `payments`
--

INSERT INTO `payments` (`id`, `user_id`, `plan_id`, `amount`, `currency`, `payment_intent_id`, `status`, `payment_method`, `error_message`, `metadata`, `created_at`, `updated_at`) VALUES
(1, 6, 1, 199.00, 'PHP', 'pi_X9fXGQah7n1vN7QX5tsEj9tf', 'succeeded', 'card', NULL, NULL, '2025-10-05 16:53:40', '2025-10-05 16:53:40'),
(2, 2147483647, 1, 199.00, 'PHP', 'pi_TBHEe6fhQrkwzqky4dRpoKLX', 'succeeded', 'card', NULL, NULL, '2025-10-05 17:53:05', '2025-10-05 17:53:05'),
(3, 2, 1, 199.00, 'PHP', 'pi_uFVfsfUdGep35XxZcfFZMLhx', 'succeeded', 'card', NULL, NULL, '2025-10-06 13:28:45', '2025-10-06 13:28:45');

-- --------------------------------------------------------

--
-- Table structure for table `recipes`
--

CREATE TABLE `recipes` (
  `id` int(11) NOT NULL,
  `user_id` int(11) NOT NULL,
  `is_public` tinyint(1) DEFAULT 0 COMMENT 'Whether the recipe is visible to public',
  `title` varchar(255) NOT NULL,
  `slug` varchar(255) NOT NULL,
  `description` text DEFAULT NULL,
  `instructions` text DEFAULT NULL,
  `prep_time` int(11) DEFAULT NULL COMMENT 'in minutes',
  `cook_time` int(11) DEFAULT NULL COMMENT 'in minutes',
  `servings` int(11) DEFAULT NULL,
  `difficulty` enum('EASY','MEDIUM','HARD') DEFAULT 'MEDIUM' COMMENT 'Recipe difficulty level',
  `category` varchar(100) DEFAULT NULL COMMENT 'Recipe category',
  `cuisine` varchar(100) DEFAULT NULL COMMENT 'Cuisine type',
  `image` varchar(255) DEFAULT NULL,
  `is_private` tinyint(1) NOT NULL DEFAULT 0,
  `is_featured` tinyint(1) NOT NULL DEFAULT 0,
  `status` enum('DRAFT','PUBLISHED','ARCHIVED') NOT NULL DEFAULT 'DRAFT',
  `views` int(11) NOT NULL DEFAULT 0,
  `created_at` datetime(3) NOT NULL DEFAULT current_timestamp(3),
  `updated_at` datetime(3) NOT NULL,
  `approval_status` enum('pending','approved','rejected') DEFAULT 'pending',
  `admin_notes` text DEFAULT NULL,
  `approved_by` varchar(36) DEFAULT NULL,
  `approved_at` timestamp NULL DEFAULT NULL,
  `rejected_at` timestamp NULL DEFAULT NULL,
  `rejection_reason` text DEFAULT NULL,
  `submitted_at` datetime(3) DEFAULT current_timestamp(3),
  `is_premium` tinyint(1) NOT NULL DEFAULT 0,
  `price` decimal(10,2) DEFAULT NULL,
  `preview_text` text DEFAULT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;

--
-- Dumping data for table `recipes`
--

INSERT INTO `recipes` (`id`, `user_id`, `is_public`, `title`, `slug`, `description`, `instructions`, `prep_time`, `cook_time`, `servings`, `difficulty`, `category`, `cuisine`, `image`, `is_private`, `is_featured`, `status`, `views`, `created_at`, `updated_at`, `approval_status`, `admin_notes`, `approved_by`, `approved_at`, `rejected_at`, `rejection_reason`, `submitted_at`, `is_premium`, `price`, `preview_text`) VALUES
(1, 76, 1, 'Adobo', 'adobo-mgclubn2', 'adobo', NULL, 15, 50, 3, 'MEDIUM', 'main-course', 'american', NULL, 0, 0, 'PUBLISHED', 0, '2025-10-05 02:26:48.302', '2025-10-06 04:54:12.000', 'approved', NULL, NULL, NULL, NULL, NULL, '2025-10-05 02:26:48.306', 0, NULL, NULL),
(6, 76, 0, 'Sinigang', 'sinigang-mgcps3y4', 'baboy', NULL, 15, 60, 6, 'EASY', 'main-course', 'american', NULL, 0, 0, 'DRAFT', 0, '2025-10-05 04:17:03.484', '2025-10-06 04:54:12.000', 'approved', NULL, NULL, NULL, NULL, NULL, '2025-10-05 04:17:03.484', 0, NULL, NULL),
(7, 76, 1, 'Grilled Chicken Penne al Fresco', 'grilled chicken penne al fresco-mgcyrv5r', 'chicken', NULL, 20, 90, 6, 'HARD', 'main-course', 'french', NULL, 0, 0, 'PUBLISHED', 0, '2025-10-05 08:28:48.639', '2025-10-06 04:54:12.000', 'approved', NULL, NULL, NULL, NULL, NULL, '2025-10-05 08:28:48.639', 0, NULL, NULL),
(91, 76, 0, 'French Onion Beef Stew', 'french-onion-beef-stew-1e2b0b0b', 'this is the best!!!', '1. Pre-heat oven to 160°C/140°C fan-forced.\r\n2. Place beef in a bowl with 1 tbs flour. Season, tossing to combine. Heat oil in a deep ovenproof frying pan over medium-high heat. Cook beef, in 2 batches, for 5 minutes, turning occasionally, or until browned. Transfer to a plate.\r\n3. Add onion, thyme and bay leaves to pan. Cook, stirring frequently, for 8 minutes or until onion has softened. Add all-spice and remaining flour, then cook, stirring, for further 1 minute, And sherry (if using), Worcestershire sauce, stock and vinegar, then bring to the boil. Cook for 4 minutes or until reduced slightly. Return beef to pan. Cover, then transfer to the oven and cook for 2½ hours.\r\n4. Preheat grill on high. Arrange baguette slices over beef mixture. Scatter over cheese. Grill for 5 minutes or until golden. Scatter over extra thyme and serve.', 15, 180, 4, 'HARD', 'main-course', 'french', '/uploads/recipes/0a3d3bec-4ed5-4693-a01a-57205f3c9467.jpg', 0, 0, 'PUBLISHED', 0, '2025-10-07 04:59:24.599', '2025-10-07 05:00:19.000', 'approved', NULL, NULL, NULL, NULL, NULL, '2025-10-07 04:59:24.599', 0, NULL, NULL),
(93, 76, 1, 'Indian Pumpkin and Chickpea Curry', 'indian-pumpkin-and-chickpea-curry-d881a698', 'Curry yesss point 3!!', '1. Heat oil in a large heavy-based saucepan over medium heat. Add onion and cook for 10 minutes or until softened. Add ginger, curry paste, cinnamon and cardamom. Cook, stirring, for 2 minutes or until fragrant.\r\n2. Add pumpkin, tomato and coconut milk. Bring to a simmer and cook, partially covered, for 20 minutes, then add chickpeas. Simmer for a further 12 minutes or until pumpkin is tender. Stir in chopped coriander. Serve with rice, and topped with remaining coriander and chilli.', 10, 45, 4, 'MEDIUM', 'main-course', 'indian', '/uploads/recipes/bd8bb025-5892-43fe-942c-1d032d574cb1.jpg', 0, 0, 'PUBLISHED', 0, '2025-10-07 14:25:13.114', '2025-10-07 14:25:53.000', 'approved', NULL, NULL, NULL, NULL, NULL, '2025-10-07 14:25:13.114', 1, 200.00, 'you should try this recipe you will love it!!!');

--
-- Triggers `recipes`
--
DELIMITER $$
CREATE TRIGGER `before_recipe_update` BEFORE UPDATE ON `recipes` FOR EACH ROW BEGIN
  SET NEW.updated_at = CURRENT_TIMESTAMP;
END
$$
DELIMITER ;

-- --------------------------------------------------------

--
-- Table structure for table `recipe_categories`
--

CREATE TABLE `recipe_categories` (
  `recipe_id` int(11) NOT NULL,
  `category_id` int(11) NOT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;

-- --------------------------------------------------------

--
-- Table structure for table `recipe_cuisines`
--

CREATE TABLE `recipe_cuisines` (
  `recipe_id` int(11) NOT NULL,
  `cuisine_id` int(11) NOT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;

-- --------------------------------------------------------

--
-- Table structure for table `recipe_ingredients`
--

CREATE TABLE `recipe_ingredients` (
  `id` int(11) NOT NULL,
  `recipe_id` int(11) NOT NULL,
  `ingredient_id` int(11) DEFAULT NULL,
  `name` varchar(255) NOT NULL,
  `amount` decimal(10,2) DEFAULT NULL COMMENT 'Amount of the ingredient',
  `unit` varchar(50) DEFAULT NULL COMMENT 'Unit of measurement',
  `notes` varchar(255) DEFAULT NULL,
  `order` int(11) NOT NULL DEFAULT 0,
  `position` int(11) DEFAULT 0 COMMENT 'Order of the ingredient in the list',
  `is_optional` tinyint(1) DEFAULT 0 COMMENT 'Whether the ingredient is optional',
  `updated_at` timestamp NOT NULL DEFAULT current_timestamp() ON UPDATE current_timestamp() COMMENT 'Last update timestamp'
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='Stores ingredients for each recipe with amounts and units';

--
-- Dumping data for table `recipe_ingredients`
--

INSERT INTO `recipe_ingredients` (`id`, `recipe_id`, `ingredient_id`, `name`, `amount`, `unit`, `notes`, `order`, `position`, `is_optional`, `updated_at`) VALUES
(31, 1, NULL, 'chicken', 1.00, 'kg', NULL, 1, 1, 0, '2025-10-04 18:26:48'),
(32, 6, NULL, 'Pork meat', 1.00, 'kg', NULL, 1, 1, 0, '2025-10-04 20:17:03'),
(33, 7, NULL, 'Chicken', 1.00, 'kg', NULL, 1, 1, 0, '2025-10-05 00:28:48'),
(34, 91, NULL, 'Beef chuck steak, fat trimmed, cut into 6cm pieces', 1.00, 'kg', NULL, 1, 1, 0, '2025-10-06 20:59:24'),
(35, 91, NULL, 'Plain flour', 2.00, 'tbs', NULL, 2, 2, 0, '2025-10-06 20:59:24'),
(36, 91, NULL, 'Extra  Virgin Olive Oil', 1.00, 'tbs', NULL, 3, 3, 0, '2025-10-06 20:59:24'),
(37, 91, NULL, 'Large Brown onions, thickly sliced', 4.00, 'pieces', NULL, 4, 4, 0, '2025-10-06 20:59:24'),
(38, 91, NULL, 'Thyme, leaves picked, chopped, plus extra to serve', 1.00, 'bunch', NULL, 5, 5, 0, '2025-10-06 20:59:24'),
(39, 91, NULL, 'Dry bay leaves', 6.00, 'pcs', NULL, 6, 6, 0, '2025-10-06 20:59:24'),
(40, 91, NULL, 'Ground allspice', 0.50, 'tsp', NULL, 7, 7, 0, '2025-10-06 20:59:24'),
(41, 91, NULL, 'Dry Sherry (Optional)', 0.50, 'cup', NULL, 8, 8, 0, '2025-10-06 20:59:24'),
(42, 91, NULL, 'Worcestershire sauce', 2.00, 'tbs', NULL, 9, 9, 0, '2025-10-06 20:59:24'),
(43, 91, NULL, 'Salt-reduced Chicken stock', 1.50, 'L', NULL, 10, 10, 0, '2025-10-06 20:59:24'),
(44, 91, NULL, 'White wine Vinegar', 2.00, 'tbs', NULL, 11, 11, 0, '2025-10-06 20:59:24'),
(45, 91, NULL, 'Baguette, cut into 1.5cm-thick slices', 0.50, 'pc', NULL, 12, 12, 0, '2025-10-06 20:59:24'),
(46, 91, NULL, 'Gruyere, grated', 200.00, 'grams', NULL, 13, 13, 0, '2025-10-06 20:59:24'),
(47, 93, NULL, 'Vegetable Oil', 1.00, 'tbs', NULL, 1, 1, 0, '2025-10-07 06:25:13'),
(48, 93, NULL, 'Brown onion, chopped 4cm-piece ginger, peeled, finely grated', 1.00, 'pc', NULL, 2, 2, 0, '2025-10-07 06:25:13'),
(49, 93, NULL, 'Madras curry paste', 1.00, 'cup', NULL, 3, 3, 0, '2025-10-07 06:25:13'),
(50, 93, NULL, 'Cinnamon sticks', 1.00, 'pc', NULL, 4, 4, 0, '2025-10-07 06:25:13'),
(51, 93, NULL, 'Cardamom pods', 4.00, 'pcs', NULL, 5, 5, 0, '2025-10-07 06:25:13'),
(52, 93, NULL, 'Butternut pumpkin, peeled, deseeded, cut into 1.5 pieces', 500.00, 'grams', NULL, 6, 6, 0, '2025-10-07 06:25:13'),
(53, 93, NULL, 'Tomatoes, chopped', 2.00, 'pcs', NULL, 7, 7, 0, '2025-10-07 06:25:13'),
(54, 93, NULL, 'Can coconut milk', 400.00, 'ml', NULL, 8, 8, 0, '2025-10-07 06:25:13'),
(55, 93, NULL, 'Cans chickpeas, rinsed, drained (2 x 400grams)', 800.00, 'grams', NULL, 9, 9, 0, '2025-10-07 06:25:13'),
(56, 93, NULL, 'Chopped coriander leaves, plus extra to serve', 2.00, 'tbs', NULL, 10, 10, 0, '2025-10-07 06:25:13'),
(57, 93, NULL, 'Steamed Basmati rice and thinly sliced fresh red chill, to serve', 0.00, '0', NULL, 11, 11, 0, '2025-10-07 06:25:13');

--
-- Triggers `recipe_ingredients`
--
DELIMITER $$
CREATE TRIGGER `before_recipe_ingredient_update` BEFORE UPDATE ON `recipe_ingredients` FOR EACH ROW BEGIN
    SET NEW.updated_at = CURRENT_TIMESTAMP;
END
$$
DELIMITER ;

-- --------------------------------------------------------

--
-- Table structure for table `recipe_status_history`
--

CREATE TABLE `recipe_status_history` (
  `id` int(11) NOT NULL,
  `recipe_id` varchar(191) NOT NULL,
  `status` enum('pending','approved','rejected','draft','published','archived') NOT NULL,
  `changed_by` varchar(191) DEFAULT NULL,
  `notes` text DEFAULT NULL,
  `created_at` timestamp NOT NULL DEFAULT current_timestamp()
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;

--
-- Dumping data for table `recipe_status_history`
--

INSERT INTO `recipe_status_history` (`id`, `recipe_id`, `status`, `changed_by`, `notes`, `created_at`) VALUES
(2, 'sinigang-mgcps3y4', 'approved', '76', 'Status changed to approved', '2025-10-04 23:11:45'),
(3, 'sinigang-mgcps3y4', 'approved', '76', 'Status changed to approved', '2025-10-04 23:12:36'),
(4, 'sinigang-mgcps3y4', 'approved', '76', 'Status changed to approved', '2025-10-04 23:12:39'),
(5, 'sinigang-mgcps3y4', 'approved', '76', 'Status changed to approved', '2025-10-04 23:12:40'),
(6, 'sinigang-mgcps3y4', 'approved', '76', 'Status changed to approved', '2025-10-04 23:12:41'),
(7, 'sinigang-mgcps3y4', 'approved', '76', 'Status changed to approved', '2025-10-04 23:12:42'),
(8, 'sinigang-mgcps3y4', 'approved', '76', 'Status changed to approved', '2025-10-04 23:12:43'),
(9, 'sinigang-mgcps3y4', 'approved', '76', 'Status changed to approved', '2025-10-04 23:12:44'),
(10, '6', 'approved', '76', 'Status changed to approved', '2025-10-04 23:25:24'),
(11, '91', 'pending', '76', 'Recipe submitted for moderation', '2025-10-06 20:59:24'),
(12, '91', 'approved', '76', 'Status changed to approved', '2025-10-06 21:00:19'),
(13, '93', 'pending', '76', 'Recipe submitted for moderation', '2025-10-07 06:25:13'),
(14, '93', 'approved', '76', 'Status changed to approved', '2025-10-07 06:25:53');

-- --------------------------------------------------------

--
-- Table structure for table `recipe_tags`
--

CREATE TABLE `recipe_tags` (
  `recipe_id` int(11) NOT NULL,
  `tag_id` int(11) NOT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;

-- --------------------------------------------------------

--
-- Table structure for table `reports`
--

CREATE TABLE `reports` (
  `id` int(11) NOT NULL,
  `reporter_id` int(11) NOT NULL,
  `reported_item_id` int(11) NOT NULL,
  `reported_item_type` enum('recipe','comment','user') NOT NULL,
  `reason` text NOT NULL,
  `status` enum('pending','reviewed','resolved','dismissed') NOT NULL DEFAULT 'pending',
  `reviewed_by` int(11) DEFAULT NULL,
  `reviewed_at` timestamp NULL DEFAULT NULL,
  `created_at` timestamp NOT NULL DEFAULT current_timestamp(),
  `updated_at` timestamp NOT NULL DEFAULT current_timestamp() ON UPDATE current_timestamp()
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;

-- --------------------------------------------------------

--
-- Table structure for table `reviews`
--

CREATE TABLE `reviews` (
  `id` int(11) NOT NULL,
  `user_id` int(11) NOT NULL,
  `recipe_id` int(11) NOT NULL,
  `rating` int(11) NOT NULL,
  `comment` text DEFAULT NULL,
  `created_at` datetime(3) NOT NULL DEFAULT current_timestamp(3),
  `updated_at` datetime(3) NOT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;

-- --------------------------------------------------------

--
-- Table structure for table `schema_migrations`
--

CREATE TABLE `schema_migrations` (
  `version` varchar(255) NOT NULL,
  `applied_at` datetime NOT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;

--
-- Dumping data for table `schema_migrations`
--

INSERT INTO `schema_migrations` (`version`, `applied_at`) VALUES
('005_add_recipe_creation_columns', '2025-09-30 17:56:23');

-- --------------------------------------------------------

--
-- Table structure for table `sessions`
--

CREATE TABLE `sessions` (
  `id` int(11) NOT NULL,
  `session_token` varchar(255) NOT NULL,
  `user_id` int(11) NOT NULL,
  `expires` datetime NOT NULL,
  `created_at` timestamp NOT NULL DEFAULT current_timestamp(),
  `updated_at` timestamp NOT NULL DEFAULT current_timestamp() ON UPDATE current_timestamp()
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;

-- --------------------------------------------------------

--
-- Table structure for table `shopping_lists`
--

CREATE TABLE `shopping_lists` (
  `id` int(11) NOT NULL,
  `user_id` int(11) NOT NULL,
  `name` varchar(255) NOT NULL,
  `is_active` tinyint(1) NOT NULL DEFAULT 1,
  `created_at` datetime(3) NOT NULL DEFAULT current_timestamp(3),
  `updated_at` datetime(3) NOT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;

-- --------------------------------------------------------

--
-- Table structure for table `shopping_list_items`
--

CREATE TABLE `shopping_list_items` (
  `id` int(11) NOT NULL,
  `shopping_list_id` int(11) NOT NULL,
  `ingredient_id` int(11) DEFAULT NULL,
  `name` varchar(255) NOT NULL,
  `amount` decimal(10,2) DEFAULT NULL,
  `unit` varchar(50) DEFAULT NULL,
  `is_purchased` tinyint(1) NOT NULL DEFAULT 0,
  `notes` varchar(255) DEFAULT NULL,
  `order` int(11) NOT NULL DEFAULT 0,
  `created_at` datetime(3) NOT NULL DEFAULT current_timestamp(3),
  `updated_at` datetime(3) NOT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;

-- --------------------------------------------------------

--
-- Table structure for table `subscriptions`
--

CREATE TABLE `subscriptions` (
  `id` int(11) NOT NULL,
  `user_id` int(11) NOT NULL,
  `plan_id` int(11) NOT NULL,
  `status` enum('active','canceled','expired','past_due') NOT NULL DEFAULT 'active',
  `start_date` datetime NOT NULL,
  `end_date` datetime DEFAULT NULL,
  `canceled_at` datetime DEFAULT NULL,
  `payment_method` varchar(50) DEFAULT NULL,
  `last_payment_date` datetime DEFAULT NULL,
  `next_billing_date` datetime DEFAULT NULL,
  `stripe_subscription_id` varchar(100) DEFAULT NULL,
  `stripe_customer_id` varchar(100) DEFAULT NULL,
  `created_at` timestamp NOT NULL DEFAULT current_timestamp(),
  `updated_at` timestamp NOT NULL DEFAULT current_timestamp() ON UPDATE current_timestamp()
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;

--
-- Dumping data for table `subscriptions`
--

INSERT INTO `subscriptions` (`id`, `user_id`, `plan_id`, `status`, `start_date`, `end_date`, `canceled_at`, `payment_method`, `last_payment_date`, `next_billing_date`, `stripe_subscription_id`, `stripe_customer_id`, `created_at`, `updated_at`) VALUES
(3, 76, 1, 'active', '2025-10-06 01:45:12', '2125-10-06 01:45:12', NULL, 'admin_granted', NULL, '2125-10-06 01:45:12', NULL, NULL, '2025-10-05 05:43:53', '2025-10-05 17:45:12'),
(4, 6, 1, 'active', '2025-10-06 00:53:40', '2025-11-06 00:53:40', NULL, NULL, NULL, NULL, NULL, NULL, '2025-10-05 16:53:40', '2025-10-05 16:53:40'),
(5, 2147483647, 1, 'active', '2025-10-06 01:53:05', '2025-11-06 01:53:05', NULL, NULL, NULL, NULL, NULL, NULL, '2025-10-05 17:53:05', '2025-10-05 17:53:05'),
(6, 2, 1, 'active', '2025-10-06 21:28:45', '2025-11-06 21:28:45', NULL, NULL, NULL, NULL, NULL, NULL, '2025-10-06 13:28:45', '2025-10-06 13:28:45');

--
-- Triggers `subscriptions`
--
DELIMITER $$
CREATE TRIGGER `after_subscription_update` AFTER UPDATE ON `subscriptions` FOR EACH ROW BEGIN
    IF NEW.status = 'active' THEN
        UPDATE `users` 
        SET `subscription_status` = 'active',
            `current_subscription_id` = NEW.id
        WHERE `id` = NEW.user_id;
    ELSEIF NEW.status IN ('canceled', 'expired') THEN
        UPDATE `users` 
        SET `subscription_status` = NEW.status
        WHERE `id` = NEW.user_id AND `current_subscription_id` = NEW.id;
    END IF;
END
$$
DELIMITER ;

-- --------------------------------------------------------

--
-- Table structure for table `subscription_invoices`
--

CREATE TABLE `subscription_invoices` (
  `id` int(11) NOT NULL,
  `subscription_id` int(11) NOT NULL,
  `user_id` int(11) NOT NULL,
  `amount` decimal(10,2) NOT NULL,
  `currency` varchar(3) NOT NULL DEFAULT 'USD',
  `status` enum('paid','pending','failed','refunded') NOT NULL,
  `payment_method` varchar(50) DEFAULT NULL,
  `stripe_payment_intent_id` varchar(255) DEFAULT NULL,
  `stripe_invoice_id` varchar(255) DEFAULT NULL,
  `billing_period_start` datetime DEFAULT NULL,
  `billing_period_end` datetime DEFAULT NULL,
  `paid_at` datetime DEFAULT NULL,
  `created_at` timestamp NOT NULL DEFAULT current_timestamp(),
  `updated_at` timestamp NOT NULL DEFAULT current_timestamp() ON UPDATE current_timestamp()
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;

-- --------------------------------------------------------

--
-- Table structure for table `subscription_payments`
--

CREATE TABLE `subscription_payments` (
  `id` int(11) NOT NULL,
  `subscription_id` int(11) NOT NULL,
  `amount` decimal(10,2) NOT NULL,
  `currency` varchar(3) NOT NULL DEFAULT 'USD',
  `status` enum('pending','completed','failed','refunded') NOT NULL DEFAULT 'pending',
  `payment_method` varchar(50) DEFAULT NULL,
  `transaction_id` varchar(100) DEFAULT NULL,
  `receipt_url` varchar(255) DEFAULT NULL,
  `paid_at` datetime DEFAULT NULL,
  `created_at` timestamp NOT NULL DEFAULT current_timestamp(),
  `updated_at` timestamp NOT NULL DEFAULT current_timestamp() ON UPDATE current_timestamp()
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;

-- --------------------------------------------------------

--
-- Table structure for table `subscription_plans`
--

CREATE TABLE `subscription_plans` (
  `id` int(11) NOT NULL,
  `name` varchar(100) NOT NULL,
  `slug` varchar(50) NOT NULL,
  `description` text DEFAULT NULL,
  `price` decimal(10,2) NOT NULL,
  `billing_cycle` enum('monthly','yearly') NOT NULL,
  `features` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL CHECK (json_valid(`features`)),
  `is_active` tinyint(1) DEFAULT 1,
  `created_at` timestamp NOT NULL DEFAULT current_timestamp(),
  `updated_at` timestamp NOT NULL DEFAULT current_timestamp() ON UPDATE current_timestamp(),
  `plan_id` varchar(50) NOT NULL COMMENT 'Unique identifier for the plan (e.g., basic, premium)'
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;

--
-- Dumping data for table `subscription_plans`
--

INSERT INTO `subscription_plans` (`id`, `name`, `slug`, `description`, `price`, `billing_cycle`, `features`, `is_active`, `created_at`, `updated_at`, `plan_id`) VALUES
(1, 'Premium', 'legacy-plan-1', 'Premium subscription with full access to all features (monthly)', 199.00, 'monthly', '[\"Unlimited recipe access\",\"Ad-free experience\",\"Exclusive content\",\"Priority support\"]', 1, '2025-10-05 05:43:53', '2025-10-05 17:45:12', 'LEGACY_PLAN_1'),
(3, 'Premium', 'premium-yearly', 'Premium subscription with full access to all features (yearly)', 1990.00, 'yearly', '[\"Unlimited recipe access\",\"Ad-free experience\",\"Exclusive content\",\"Priority support\",\"Yearly member badge\"]', 1, '2025-10-05 17:45:12', '2025-10-05 17:45:12', 'PREMIUM-YEARLY'),
(4, 'Basic', '', 'Basic plan with essential features', 0.00, 'monthly', '[\"Browse all public recipes\", \"Post in community\", \"Create recipes\", \"Basic support\"]', 1, '2025-10-05 20:51:06', '2025-10-05 20:54:58', '');

-- --------------------------------------------------------

--
-- Table structure for table `tags`
--

CREATE TABLE `tags` (
  `id` int(11) NOT NULL,
  `name` varchar(50) NOT NULL,
  `slug` varchar(50) NOT NULL,
  `created_at` datetime(3) NOT NULL DEFAULT current_timestamp(3)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;

-- --------------------------------------------------------

--
-- Table structure for table `users`
--

CREATE TABLE `users` (
  `id` int(11) NOT NULL,
  `name` varchar(100) NOT NULL,
  `email` varchar(255) NOT NULL,
  `password` varchar(255) DEFAULT NULL,
  `image` varchar(255) DEFAULT NULL,
  `role` enum('USER','ADMIN') NOT NULL DEFAULT 'USER',
  `email_verified` tinyint(1) DEFAULT 0,
  `subscription_status` enum('active','canceled','expired','none') NOT NULL DEFAULT 'none',
  `current_subscription_id` int(11) DEFAULT NULL,
  `verification_token` varchar(255) DEFAULT NULL,
  `reset_token` varchar(255) DEFAULT NULL,
  `reset_token_expires` datetime DEFAULT NULL,
  `created_at` datetime(3) NOT NULL DEFAULT current_timestamp(3),
  `updated_at` datetime(3) NOT NULL,
  `is_verified` tinyint(1) NOT NULL DEFAULT 0
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;

--
-- Dumping data for table `users`
--

INSERT INTO `users` (`id`, `name`, `email`, `password`, `image`, `role`, `email_verified`, `subscription_status`, `current_subscription_id`, `verification_token`, `reset_token`, `reset_token_expires`, `created_at`, `updated_at`, `is_verified`) VALUES
(2, 'Naruto Uzumaki', 'uzumakima@example.com', '$2a$12$nntvzXzWmkx.vreTpsMor.XVEi5H1aQkqpChcwFNX9P6Fu5MMZL4G', NULL, 'USER', 127, 'active', 6, NULL, NULL, NULL, '2025-10-06 21:00:31.351', '2025-10-06 22:33:06.000', 1),
(6, 'Matty', 'test@example.com', '$2a$12$PZmy2y8YnHkuOvFb4Z8IM.fKEwWTpqjzJ42zbsSvN2JsIdRTaUWoG', NULL, 'USER', 127, 'active', 4, NULL, NULL, NULL, '2025-09-28 21:51:12.129', '2025-10-06 22:33:06.000', 1),
(7, 'Test User', 'test-1759067601307@example.com', NULL, NULL, 'USER', 127, 'none', NULL, NULL, NULL, NULL, '2025-09-28 21:53:21.309', '2025-10-06 22:33:06.000', 0),
(9, 'Test User', 'test-1759067776395@example.com', '$2a$12$KxG8NxY3nX1MqB8zL5kQkOQ5VQ1X9JcX9JcX9JcX9JcX9JcX9Jc', NULL, 'USER', 127, 'none', NULL, NULL, NULL, NULL, '2025-09-28 21:56:16.396', '2025-10-06 22:33:06.000', 0),
(73, 'JOhn Doe', 'admin1@example.com', '$2a$12$oQDoS65ajhJyl5VGqsrIRe/4GwcdlwIgEvQnJ3/waW3gw7UNbMthq', NULL, 'USER', 127, 'none', NULL, NULL, NULL, NULL, '2025-09-28 22:00:01.000', '2025-10-06 22:33:06.000', 0),
(76, 'Admin User', 'savoryadmin@example.com', '$2a$10$Z67wwG4ZRJWVxmlUVArm3OANk./kOLqa/xZsj981q90WJF8EPmKZ6', NULL, 'ADMIN', 0, 'active', 3, NULL, NULL, NULL, '2025-09-29 19:46:22.175', '2025-10-06 22:33:06.000', 1),
(2147483647, 'Matthieu Ortizo', 'matthieu2002@example.com', '$2a$12$MBdjjc7UEgTWflV6kkIb9OU3NDyNkWqsPhxXk4LFlCXc2T8A/PsIO', NULL, 'USER', 127, 'active', 5, NULL, NULL, NULL, '2025-10-06 01:50:45.520', '2025-10-06 22:33:06.000', 1);

-- --------------------------------------------------------

--
-- Table structure for table `user_auth_providers`
--

CREATE TABLE `user_auth_providers` (
  `id` int(11) NOT NULL,
  `user_id` int(11) NOT NULL,
  `provider` enum('GOOGLE','GITHUB','FACEBOOK','CREDENTIALS') NOT NULL,
  `provider_user_id` varchar(255) NOT NULL,
  `access_token` text DEFAULT NULL,
  `refresh_token` text DEFAULT NULL,
  `expires_at` int(11) DEFAULT NULL,
  `created_at` datetime(3) NOT NULL DEFAULT current_timestamp(3),
  `updated_at` datetime(3) NOT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;

-- --------------------------------------------------------

--
-- Table structure for table `user_favorites`
--

CREATE TABLE `user_favorites` (
  `user_id` int(11) NOT NULL,
  `recipe_id` int(11) NOT NULL,
  `created_at` datetime(3) NOT NULL DEFAULT current_timestamp(3)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;

-- --------------------------------------------------------

--
-- Table structure for table `user_followers`
--

CREATE TABLE `user_followers` (
  `follower_id` int(11) NOT NULL,
  `following_id` int(11) NOT NULL,
  `created_at` datetime(3) NOT NULL DEFAULT current_timestamp(3)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;

-- --------------------------------------------------------

--
-- Table structure for table `user_profiles`
--

CREATE TABLE `user_profiles` (
  `user_id` int(11) NOT NULL,
  `bio` text DEFAULT NULL,
  `location` varchar(100) DEFAULT NULL,
  `website` varchar(255) DEFAULT NULL,
  `social_links` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL CHECK (json_valid(`social_links`)),
  `dietary_preferences` longtext CHARACTER SET utf8mb4 COLLATE utf8mb4_bin DEFAULT NULL CHECK (json_valid(`dietary_preferences`)),
  `notifications_enabled` tinyint(1) NOT NULL DEFAULT 1,
  `email_notifications` tinyint(1) NOT NULL DEFAULT 1,
  `created_at` datetime(3) NOT NULL DEFAULT current_timestamp(3),
  `updated_at` datetime(3) NOT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;

-- --------------------------------------------------------

--
-- Table structure for table `user_subscriptions`
--

CREATE TABLE `user_subscriptions` (
  `id` int(11) NOT NULL,
  `user_id` int(11) NOT NULL,
  `plan_id` int(11) NOT NULL,
  `paymongo_subscription_id` varchar(255) NOT NULL,
  `status` enum('active','past_due','unpaid','canceled','incomplete','incomplete_expired','trialing') NOT NULL,
  `current_period_start` datetime NOT NULL,
  `current_period_end` datetime NOT NULL,
  `cancel_at_period_end` tinyint(1) DEFAULT 0,
  `canceled_at` datetime DEFAULT NULL,
  `created_at` timestamp NOT NULL DEFAULT current_timestamp(),
  `updated_at` timestamp NOT NULL DEFAULT current_timestamp() ON UPDATE current_timestamp()
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;

-- --------------------------------------------------------

--
-- Table structure for table `user_subscription_features`
--

CREATE TABLE `user_subscription_features` (
  `id` int(11) NOT NULL,
  `user_id` int(11) NOT NULL,
  `feature` varchar(100) NOT NULL,
  `is_active` tinyint(1) DEFAULT 1,
  `created_at` timestamp NOT NULL DEFAULT current_timestamp(),
  `updated_at` timestamp NOT NULL DEFAULT current_timestamp() ON UPDATE current_timestamp()
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;

-- --------------------------------------------------------

--
-- Table structure for table `verification_requests`
--

CREATE TABLE `verification_requests` (
  `id` int(11) NOT NULL,
  `user_id` int(11) NOT NULL,
  `document_url` varchar(255) NOT NULL,
  `status` enum('pending','approved','rejected') NOT NULL DEFAULT 'pending',
  `reviewed_by` int(11) DEFAULT NULL,
  `reviewed_at` timestamp NULL DEFAULT NULL,
  `rejection_reason` text DEFAULT NULL,
  `created_at` timestamp NOT NULL DEFAULT current_timestamp(),
  `updated_at` timestamp NOT NULL DEFAULT current_timestamp() ON UPDATE current_timestamp()
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;

-- --------------------------------------------------------

--
-- Table structure for table `verification_tokens`
--

CREATE TABLE `verification_tokens` (
  `id` int(11) NOT NULL,
  `identifier` varchar(255) NOT NULL,
  `token` varchar(255) NOT NULL,
  `expires` datetime NOT NULL,
  `created_at` timestamp NOT NULL DEFAULT current_timestamp()
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;

-- --------------------------------------------------------

--
-- Stand-in structure for view `vw_recipe_details`
-- (See below for the actual view)
--
CREATE TABLE `vw_recipe_details` (
`id` int(11)
,`user_id` int(11)
,`is_public` tinyint(1)
,`title` varchar(255)
,`slug` varchar(255)
,`description` text
,`prep_time` int(11)
,`cook_time` int(11)
,`servings` int(11)
,`difficulty` enum('EASY','MEDIUM','HARD')
,`category` varchar(100)
,`cuisine` varchar(100)
,`image` varchar(255)
,`is_private` tinyint(1)
,`is_featured` tinyint(1)
,`status` enum('DRAFT','PUBLISHED','ARCHIVED')
,`views` int(11)
,`created_at` datetime(3)
,`updated_at` datetime(3)
,`author_name` varchar(100)
,`author_image` varchar(255)
,`favorite_count` bigint(21)
,`average_rating` decimal(14,4)
,`rating_count` bigint(21)
,`comment_count` bigint(21)
,`primary_category` varchar(100)
,`primary_cuisine` varchar(100)
);

-- --------------------------------------------------------

--
-- Structure for view `vw_recipe_details`
--
DROP TABLE IF EXISTS `vw_recipe_details`;

CREATE ALGORITHM=UNDEFINED DEFINER=`root`@`localhost` SQL SECURITY DEFINER VIEW `vw_recipe_details`  AS SELECT `r`.`id` AS `id`, `r`.`user_id` AS `user_id`, `r`.`is_public` AS `is_public`, `r`.`title` AS `title`, `r`.`slug` AS `slug`, `r`.`description` AS `description`, `r`.`prep_time` AS `prep_time`, `r`.`cook_time` AS `cook_time`, `r`.`servings` AS `servings`, `r`.`difficulty` AS `difficulty`, `r`.`category` AS `category`, `r`.`cuisine` AS `cuisine`, `r`.`image` AS `image`, `r`.`is_private` AS `is_private`, `r`.`is_featured` AS `is_featured`, `r`.`status` AS `status`, `r`.`views` AS `views`, `r`.`created_at` AS `created_at`, `r`.`updated_at` AS `updated_at`, `u`.`name` AS `author_name`, `u`.`image` AS `author_image`, (select count(0) from `user_favorites` `uf` where `uf`.`recipe_id` = `r`.`id`) AS `favorite_count`, (select avg(`reviews`.`rating`) from `reviews` where `reviews`.`recipe_id` = `r`.`id`) AS `average_rating`, (select count(0) from `reviews` where `reviews`.`recipe_id` = `r`.`id`) AS `rating_count`, (select count(0) from `comments` where `comments`.`recipe_id` = `r`.`id`) AS `comment_count`, (select `c`.`name` from (`categories` `c` join `recipe_categories` `rc` on(`c`.`id` = `rc`.`category_id`)) where `rc`.`recipe_id` = `r`.`id` limit 1) AS `primary_category`, (select `c`.`name` from (`cuisines` `c` join `recipe_cuisines` `rc` on(`c`.`id` = `rc`.`cuisine_id`)) where `rc`.`recipe_id` = `r`.`id` limit 1) AS `primary_cuisine` FROM (`recipes` `r` left join `users` `u` on(`r`.`user_id` = `u`.`id`)) WHERE `r`.`status` = 'PUBLISHED' ;

--
-- Indexes for dumped tables
--

--
-- Indexes for table `accounts`
--
ALTER TABLE `accounts`
  ADD PRIMARY KEY (`id`),
  ADD UNIQUE KEY `provider_provider_account_id` (`provider`,`provider_account_id`),
  ADD KEY `user_id` (`user_id`);

--
-- Indexes for table `admin_sessions`
--
ALTER TABLE `admin_sessions`
  ADD PRIMARY KEY (`id`),
  ADD UNIQUE KEY `uniq_admin_session_user` (`user_id`),
  ADD UNIQUE KEY `uniq_admin_session_token` (`session_token`);

--
-- Indexes for table `admin_settings`
--
ALTER TABLE `admin_settings`
  ADD PRIMARY KEY (`id`),
  ADD UNIQUE KEY `setting_key` (`setting_key`);

--
-- Indexes for table `audit_logs`
--
ALTER TABLE `audit_logs`
  ADD PRIMARY KEY (`id`),
  ADD KEY `idx_audit_logs_user_id` (`user_id`),
  ADD KEY `idx_audit_logs_entity` (`entity_type`,`entity_id`);

--
-- Indexes for table `categories`
--
ALTER TABLE `categories`
  ADD PRIMARY KEY (`id`),
  ADD UNIQUE KEY `categories_slug_key` (`slug`);

--
-- Indexes for table `collections`
--
ALTER TABLE `collections`
  ADD PRIMARY KEY (`id`),
  ADD KEY `user_id` (`user_id`);

--
-- Indexes for table `collection_recipes`
--
ALTER TABLE `collection_recipes`
  ADD PRIMARY KEY (`collection_id`,`recipe_id`),
  ADD KEY `recipe_id` (`recipe_id`);

--
-- Indexes for table `comments`
--
ALTER TABLE `comments`
  ADD PRIMARY KEY (`id`),
  ADD KEY `user_id` (`user_id`),
  ADD KEY `recipe_id` (`recipe_id`),
  ADD KEY `parent_id` (`parent_id`);

--
-- Indexes for table `community_posts`
--
ALTER TABLE `community_posts`
  ADD PRIMARY KEY (`id`),
  ADD KEY `idx_user_id` (`user_id`),
  ADD KEY `idx_created_at` (`created_at`);

--
-- Indexes for table `community_post_images`
--
ALTER TABLE `community_post_images`
  ADD PRIMARY KEY (`id`),
  ADD UNIQUE KEY `uniq_post_image` (`post_id`),
  ADD KEY `idx_post_images_post_id` (`post_id`);

--
-- Indexes for table `community_post_likes`
--
ALTER TABLE `community_post_likes`
  ADD PRIMARY KEY (`id`),
  ADD UNIQUE KEY `unique_post_like` (`post_id`,`user_id`),
  ADD KEY `idx_post_id` (`post_id`),
  ADD KEY `idx_like_user_id` (`user_id`);

--
-- Indexes for table `cuisines`
--
ALTER TABLE `cuisines`
  ADD PRIMARY KEY (`id`),
  ADD UNIQUE KEY `cuisines_slug_key` (`slug`);

--
-- Indexes for table `ingredients`
--
ALTER TABLE `ingredients`
  ADD PRIMARY KEY (`id`),
  ADD UNIQUE KEY `ingredients_slug_key` (`slug`);

--
-- Indexes for table `instructions`
--
ALTER TABLE `instructions`
  ADD PRIMARY KEY (`id`),
  ADD KEY `recipe_id` (`recipe_id`);

--
-- Indexes for table `meal_plans`
--
ALTER TABLE `meal_plans`
  ADD PRIMARY KEY (`id`),
  ADD KEY `user_id` (`user_id`);

--
-- Indexes for table `meal_plan_days`
--
ALTER TABLE `meal_plan_days`
  ADD PRIMARY KEY (`id`),
  ADD KEY `meal_plan_id` (`meal_plan_id`);

--
-- Indexes for table `meal_plan_meals`
--
ALTER TABLE `meal_plan_meals`
  ADD PRIMARY KEY (`id`),
  ADD KEY `day_id` (`day_id`),
  ADD KEY `recipe_id` (`recipe_id`);

--
-- Indexes for table `notifications`
--
ALTER TABLE `notifications`
  ADD PRIMARY KEY (`id`),
  ADD KEY `user_id` (`user_id`),
  ADD KEY `is_read` (`is_read`),
  ADD KEY `related` (`related_type`,`related_id`);

--
-- Indexes for table `nutritional_info`
--
ALTER TABLE `nutritional_info`
  ADD PRIMARY KEY (`recipe_id`);

--
-- Indexes for table `payments`
--
ALTER TABLE `payments`
  ADD PRIMARY KEY (`id`),
  ADD UNIQUE KEY `unique_payment_intent` (`payment_intent_id`),
  ADD KEY `idx_user_id` (`user_id`),
  ADD KEY `idx_plan_id` (`plan_id`),
  ADD KEY `idx_status` (`status`);

--
-- Indexes for table `recipes`
--
ALTER TABLE `recipes`
  ADD PRIMARY KEY (`id`),
  ADD UNIQUE KEY `recipes_slug_key` (`slug`),
  ADD KEY `user_id` (`user_id`),
  ADD KEY `status` (`status`),
  ADD KEY `idx_recipes_user_public` (`user_id`,`is_public`),
  ADD KEY `idx_approval_status` (`approval_status`);

--
-- Indexes for table `recipe_categories`
--
ALTER TABLE `recipe_categories`
  ADD PRIMARY KEY (`recipe_id`,`category_id`),
  ADD KEY `category_id` (`category_id`);

--
-- Indexes for table `recipe_cuisines`
--
ALTER TABLE `recipe_cuisines`
  ADD PRIMARY KEY (`recipe_id`,`cuisine_id`),
  ADD KEY `cuisine_id` (`cuisine_id`);

--
-- Indexes for table `recipe_ingredients`
--
ALTER TABLE `recipe_ingredients`
  ADD PRIMARY KEY (`id`),
  ADD KEY `recipe_id` (`recipe_id`),
  ADD KEY `ingredient_id` (`ingredient_id`),
  ADD KEY `idx_ingredients_recipe` (`recipe_id`,`position`);

--
-- Indexes for table `recipe_status_history`
--
ALTER TABLE `recipe_status_history`
  ADD PRIMARY KEY (`id`),
  ADD KEY `idx_recipe_status_recipe_id` (`recipe_id`),
  ADD KEY `idx_recipe_status_status` (`status`),
  ADD KEY `idx_recipe_status_changed_by` (`changed_by`);

--
-- Indexes for table `recipe_tags`
--
ALTER TABLE `recipe_tags`
  ADD PRIMARY KEY (`recipe_id`,`tag_id`),
  ADD KEY `tag_id` (`tag_id`);

--
-- Indexes for table `reports`
--
ALTER TABLE `reports`
  ADD PRIMARY KEY (`id`),
  ADD KEY `reporter_id` (`reporter_id`),
  ADD KEY `reviewed_by` (`reviewed_by`),
  ADD KEY `idx_reports_status` (`status`),
  ADD KEY `idx_reports_reported_item` (`reported_item_type`,`reported_item_id`);

--
-- Indexes for table `reviews`
--
ALTER TABLE `reviews`
  ADD PRIMARY KEY (`id`),
  ADD UNIQUE KEY `reviews_user_id_recipe_id_key` (`user_id`,`recipe_id`),
  ADD KEY `recipe_id` (`recipe_id`);

--
-- Indexes for table `schema_migrations`
--
ALTER TABLE `schema_migrations`
  ADD PRIMARY KEY (`version`);

--
-- Indexes for table `sessions`
--
ALTER TABLE `sessions`
  ADD PRIMARY KEY (`id`),
  ADD UNIQUE KEY `session_token` (`session_token`),
  ADD KEY `user_id` (`user_id`);

--
-- Indexes for table `shopping_lists`
--
ALTER TABLE `shopping_lists`
  ADD PRIMARY KEY (`id`),
  ADD KEY `user_id` (`user_id`);

--
-- Indexes for table `shopping_list_items`
--
ALTER TABLE `shopping_list_items`
  ADD PRIMARY KEY (`id`),
  ADD KEY `shopping_list_id` (`shopping_list_id`),
  ADD KEY `ingredient_id` (`ingredient_id`);

--
-- Indexes for table `subscriptions`
--
ALTER TABLE `subscriptions`
  ADD PRIMARY KEY (`id`),
  ADD KEY `idx_user_id` (`user_id`),
  ADD KEY `idx_plan_id` (`plan_id`),
  ADD KEY `idx_status` (`status`),
  ADD KEY `idx_stripe_subscription_id` (`stripe_subscription_id`);

--
-- Indexes for table `subscription_invoices`
--
ALTER TABLE `subscription_invoices`
  ADD PRIMARY KEY (`id`),
  ADD KEY `subscription_id` (`subscription_id`),
  ADD KEY `user_id` (`user_id`);

--
-- Indexes for table `subscription_payments`
--
ALTER TABLE `subscription_payments`
  ADD PRIMARY KEY (`id`),
  ADD KEY `idx_subscription_id` (`subscription_id`),
  ADD KEY `idx_transaction_id` (`transaction_id`);

--
-- Indexes for table `subscription_plans`
--
ALTER TABLE `subscription_plans`
  ADD PRIMARY KEY (`id`),
  ADD UNIQUE KEY `slug` (`slug`),
  ADD UNIQUE KEY `plan_id` (`plan_id`),
  ADD KEY `idx_plan_slug` (`slug`),
  ADD KEY `idx_plan_active` (`is_active`);

--
-- Indexes for table `tags`
--
ALTER TABLE `tags`
  ADD PRIMARY KEY (`id`),
  ADD UNIQUE KEY `tags_slug_key` (`slug`);

--
-- Indexes for table `users`
--
ALTER TABLE `users`
  ADD PRIMARY KEY (`id`),
  ADD UNIQUE KEY `users_email_key` (`email`),
  ADD UNIQUE KEY `email` (`email`),
  ADD UNIQUE KEY `users_verification_token_key` (`verification_token`),
  ADD UNIQUE KEY `users_reset_token_key` (`reset_token`),
  ADD KEY `fk_user_current_subscription` (`current_subscription_id`),
  ADD KEY `idx_user_subscription` (`subscription_status`,`current_subscription_id`);

--
-- Indexes for table `user_auth_providers`
--
ALTER TABLE `user_auth_providers`
  ADD PRIMARY KEY (`id`),
  ADD UNIQUE KEY `user_auth_providers_provider_provider_user_id_key` (`provider`,`provider_user_id`),
  ADD KEY `user_auth_providers_user_id_fkey` (`user_id`);

--
-- Indexes for table `user_favorites`
--
ALTER TABLE `user_favorites`
  ADD PRIMARY KEY (`user_id`,`recipe_id`),
  ADD KEY `recipe_id` (`recipe_id`);

--
-- Indexes for table `user_followers`
--
ALTER TABLE `user_followers`
  ADD PRIMARY KEY (`follower_id`,`following_id`),
  ADD KEY `following_id` (`following_id`);

--
-- Indexes for table `user_profiles`
--
ALTER TABLE `user_profiles`
  ADD PRIMARY KEY (`user_id`);

--
-- Indexes for table `user_subscriptions`
--
ALTER TABLE `user_subscriptions`
  ADD PRIMARY KEY (`id`),
  ADD KEY `plan_id` (`plan_id`),
  ADD KEY `idx_user_subscription` (`user_id`,`status`),
  ADD KEY `idx_paymongo_id` (`paymongo_subscription_id`);

--
-- Indexes for table `user_subscription_features`
--
ALTER TABLE `user_subscription_features`
  ADD PRIMARY KEY (`id`),
  ADD UNIQUE KEY `idx_user_feature` (`user_id`,`feature`);

--
-- Indexes for table `verification_requests`
--
ALTER TABLE `verification_requests`
  ADD PRIMARY KEY (`id`),
  ADD KEY `user_id` (`user_id`),
  ADD KEY `reviewed_by` (`reviewed_by`),
  ADD KEY `idx_verification_requests_status` (`status`);

--
-- Indexes for table `verification_tokens`
--
ALTER TABLE `verification_tokens`
  ADD PRIMARY KEY (`id`),
  ADD UNIQUE KEY `token` (`token`),
  ADD UNIQUE KEY `identifier_token` (`identifier`,`token`);

--
-- AUTO_INCREMENT for dumped tables
--

--
-- AUTO_INCREMENT for table `accounts`
--
ALTER TABLE `accounts`
  MODIFY `id` int(11) NOT NULL AUTO_INCREMENT;

--
-- AUTO_INCREMENT for table `admin_sessions`
--
ALTER TABLE `admin_sessions`
  MODIFY `id` int(11) NOT NULL AUTO_INCREMENT, AUTO_INCREMENT=4;

--
-- AUTO_INCREMENT for table `admin_settings`
--
ALTER TABLE `admin_settings`
  MODIFY `id` int(11) NOT NULL AUTO_INCREMENT, AUTO_INCREMENT=5;

--
-- AUTO_INCREMENT for table `audit_logs`
--
ALTER TABLE `audit_logs`
  MODIFY `id` int(11) NOT NULL AUTO_INCREMENT, AUTO_INCREMENT=12;

--
-- AUTO_INCREMENT for table `categories`
--
ALTER TABLE `categories`
  MODIFY `id` int(11) NOT NULL AUTO_INCREMENT, AUTO_INCREMENT=14;

--
-- AUTO_INCREMENT for table `collections`
--
ALTER TABLE `collections`
  MODIFY `id` int(11) NOT NULL AUTO_INCREMENT;

--
-- AUTO_INCREMENT for table `comments`
--
ALTER TABLE `comments`
  MODIFY `id` int(11) NOT NULL AUTO_INCREMENT;

--
-- AUTO_INCREMENT for table `community_posts`
--
ALTER TABLE `community_posts`
  MODIFY `id` bigint(20) UNSIGNED NOT NULL AUTO_INCREMENT, AUTO_INCREMENT=2;

--
-- AUTO_INCREMENT for table `community_post_images`
--
ALTER TABLE `community_post_images`
  MODIFY `id` bigint(20) UNSIGNED NOT NULL AUTO_INCREMENT, AUTO_INCREMENT=2;

--
-- AUTO_INCREMENT for table `community_post_likes`
--
ALTER TABLE `community_post_likes`
  MODIFY `id` bigint(20) UNSIGNED NOT NULL AUTO_INCREMENT;

--
-- AUTO_INCREMENT for table `cuisines`
--
ALTER TABLE `cuisines`
  MODIFY `id` int(11) NOT NULL AUTO_INCREMENT, AUTO_INCREMENT=12;

--
-- AUTO_INCREMENT for table `ingredients`
--
ALTER TABLE `ingredients`
  MODIFY `id` int(11) NOT NULL AUTO_INCREMENT;

--
-- AUTO_INCREMENT for table `instructions`
--
ALTER TABLE `instructions`
  MODIFY `id` int(11) NOT NULL AUTO_INCREMENT, AUTO_INCREMENT=10;

--
-- AUTO_INCREMENT for table `meal_plans`
--
ALTER TABLE `meal_plans`
  MODIFY `id` int(11) NOT NULL AUTO_INCREMENT;

--
-- AUTO_INCREMENT for table `meal_plan_days`
--
ALTER TABLE `meal_plan_days`
  MODIFY `id` int(11) NOT NULL AUTO_INCREMENT;

--
-- AUTO_INCREMENT for table `meal_plan_meals`
--
ALTER TABLE `meal_plan_meals`
  MODIFY `id` int(11) NOT NULL AUTO_INCREMENT;

--
-- AUTO_INCREMENT for table `notifications`
--
ALTER TABLE `notifications`
  MODIFY `id` int(11) NOT NULL AUTO_INCREMENT;

--
-- AUTO_INCREMENT for table `payments`
--
ALTER TABLE `payments`
  MODIFY `id` int(11) NOT NULL AUTO_INCREMENT, AUTO_INCREMENT=4;

--
-- AUTO_INCREMENT for table `recipes`
--
ALTER TABLE `recipes`
  MODIFY `id` int(11) NOT NULL AUTO_INCREMENT, AUTO_INCREMENT=94;

--
-- AUTO_INCREMENT for table `recipe_ingredients`
--
ALTER TABLE `recipe_ingredients`
  MODIFY `id` int(11) NOT NULL AUTO_INCREMENT, AUTO_INCREMENT=58;

--
-- AUTO_INCREMENT for table `recipe_status_history`
--
ALTER TABLE `recipe_status_history`
  MODIFY `id` int(11) NOT NULL AUTO_INCREMENT, AUTO_INCREMENT=15;

--
-- AUTO_INCREMENT for table `reports`
--
ALTER TABLE `reports`
  MODIFY `id` int(11) NOT NULL AUTO_INCREMENT;

--
-- AUTO_INCREMENT for table `reviews`
--
ALTER TABLE `reviews`
  MODIFY `id` int(11) NOT NULL AUTO_INCREMENT;

--
-- AUTO_INCREMENT for table `sessions`
--
ALTER TABLE `sessions`
  MODIFY `id` int(11) NOT NULL AUTO_INCREMENT;

--
-- AUTO_INCREMENT for table `shopping_lists`
--
ALTER TABLE `shopping_lists`
  MODIFY `id` int(11) NOT NULL AUTO_INCREMENT;

--
-- AUTO_INCREMENT for table `shopping_list_items`
--
ALTER TABLE `shopping_list_items`
  MODIFY `id` int(11) NOT NULL AUTO_INCREMENT;

--
-- AUTO_INCREMENT for table `subscriptions`
--
ALTER TABLE `subscriptions`
  MODIFY `id` int(11) NOT NULL AUTO_INCREMENT, AUTO_INCREMENT=7;

--
-- AUTO_INCREMENT for table `subscription_invoices`
--
ALTER TABLE `subscription_invoices`
  MODIFY `id` int(11) NOT NULL AUTO_INCREMENT;

--
-- AUTO_INCREMENT for table `subscription_payments`
--
ALTER TABLE `subscription_payments`
  MODIFY `id` int(11) NOT NULL AUTO_INCREMENT;

--
-- AUTO_INCREMENT for table `subscription_plans`
--
ALTER TABLE `subscription_plans`
  MODIFY `id` int(11) NOT NULL AUTO_INCREMENT, AUTO_INCREMENT=8;

--
-- AUTO_INCREMENT for table `tags`
--
ALTER TABLE `tags`
  MODIFY `id` int(11) NOT NULL AUTO_INCREMENT;

--
-- AUTO_INCREMENT for table `users`
--
ALTER TABLE `users`
  MODIFY `id` int(11) NOT NULL AUTO_INCREMENT, AUTO_INCREMENT=2147483648;

--
-- AUTO_INCREMENT for table `user_auth_providers`
--
ALTER TABLE `user_auth_providers`
  MODIFY `id` int(11) NOT NULL AUTO_INCREMENT;

--
-- AUTO_INCREMENT for table `user_subscriptions`
--
ALTER TABLE `user_subscriptions`
  MODIFY `id` int(11) NOT NULL AUTO_INCREMENT;

--
-- AUTO_INCREMENT for table `user_subscription_features`
--
ALTER TABLE `user_subscription_features`
  MODIFY `id` int(11) NOT NULL AUTO_INCREMENT;

--
-- AUTO_INCREMENT for table `verification_requests`
--
ALTER TABLE `verification_requests`
  MODIFY `id` int(11) NOT NULL AUTO_INCREMENT;

--
-- AUTO_INCREMENT for table `verification_tokens`
--
ALTER TABLE `verification_tokens`
  MODIFY `id` int(11) NOT NULL AUTO_INCREMENT;

--
-- Constraints for dumped tables
--

--
-- Constraints for table `accounts`
--
ALTER TABLE `accounts`
  ADD CONSTRAINT `accounts_ibfk_1` FOREIGN KEY (`user_id`) REFERENCES `users` (`id`) ON DELETE CASCADE;

--
-- Constraints for table `admin_sessions`
--
ALTER TABLE `admin_sessions`
  ADD CONSTRAINT `admin_sessions_ibfk_1` FOREIGN KEY (`user_id`) REFERENCES `users` (`id`) ON DELETE CASCADE;

--
-- Constraints for table `audit_logs`
--
ALTER TABLE `audit_logs`
  ADD CONSTRAINT `audit_logs_ibfk_1` FOREIGN KEY (`user_id`) REFERENCES `users` (`id`) ON DELETE SET NULL;

--
-- Constraints for table `collections`
--
ALTER TABLE `collections`
  ADD CONSTRAINT `collections_user_id_fkey` FOREIGN KEY (`user_id`) REFERENCES `users` (`id`) ON DELETE CASCADE ON UPDATE CASCADE;

--
-- Constraints for table `collection_recipes`
--
ALTER TABLE `collection_recipes`
  ADD CONSTRAINT `collection_recipes_collection_id_fkey` FOREIGN KEY (`collection_id`) REFERENCES `collections` (`id`) ON DELETE CASCADE ON UPDATE CASCADE,
  ADD CONSTRAINT `collection_recipes_recipe_id_fkey` FOREIGN KEY (`recipe_id`) REFERENCES `recipes` (`id`) ON DELETE CASCADE ON UPDATE CASCADE;

--
-- Constraints for table `comments`
--
ALTER TABLE `comments`
  ADD CONSTRAINT `comments_parent_id_fkey` FOREIGN KEY (`parent_id`) REFERENCES `comments` (`id`) ON DELETE CASCADE ON UPDATE CASCADE,
  ADD CONSTRAINT `comments_recipe_id_fkey` FOREIGN KEY (`recipe_id`) REFERENCES `recipes` (`id`) ON DELETE CASCADE ON UPDATE CASCADE,
  ADD CONSTRAINT `comments_user_id_fkey` FOREIGN KEY (`user_id`) REFERENCES `users` (`id`) ON DELETE CASCADE ON UPDATE CASCADE;

--
-- Constraints for table `community_posts`
--
ALTER TABLE `community_posts`
  ADD CONSTRAINT `fk_community_posts_user` FOREIGN KEY (`user_id`) REFERENCES `users` (`id`) ON DELETE CASCADE;

--
-- Constraints for table `community_post_images`
--
ALTER TABLE `community_post_images`
  ADD CONSTRAINT `fk_community_post_images_post` FOREIGN KEY (`post_id`) REFERENCES `community_posts` (`id`) ON DELETE CASCADE;

--
-- Constraints for table `community_post_likes`
--
ALTER TABLE `community_post_likes`
  ADD CONSTRAINT `fk_community_post_likes_post` FOREIGN KEY (`post_id`) REFERENCES `community_posts` (`id`) ON DELETE CASCADE,
  ADD CONSTRAINT `fk_community_post_likes_user` FOREIGN KEY (`user_id`) REFERENCES `users` (`id`) ON DELETE CASCADE;

--
-- Constraints for table `instructions`
--
ALTER TABLE `instructions`
  ADD CONSTRAINT `instructions_recipe_id_fkey` FOREIGN KEY (`recipe_id`) REFERENCES `recipes` (`id`) ON DELETE CASCADE ON UPDATE CASCADE;

--
-- Constraints for table `meal_plans`
--
ALTER TABLE `meal_plans`
  ADD CONSTRAINT `meal_plans_user_id_fkey` FOREIGN KEY (`user_id`) REFERENCES `users` (`id`) ON DELETE CASCADE ON UPDATE CASCADE;

--
-- Constraints for table `meal_plan_days`
--
ALTER TABLE `meal_plan_days`
  ADD CONSTRAINT `meal_plan_days_meal_plan_id_fkey` FOREIGN KEY (`meal_plan_id`) REFERENCES `meal_plans` (`id`) ON DELETE CASCADE ON UPDATE CASCADE;

--
-- Constraints for table `meal_plan_meals`
--
ALTER TABLE `meal_plan_meals`
  ADD CONSTRAINT `meal_plan_meals_day_id_fkey` FOREIGN KEY (`day_id`) REFERENCES `meal_plan_days` (`id`) ON DELETE CASCADE ON UPDATE CASCADE,
  ADD CONSTRAINT `meal_plan_meals_recipe_id_fkey` FOREIGN KEY (`recipe_id`) REFERENCES `recipes` (`id`) ON DELETE SET NULL ON UPDATE CASCADE;

--
-- Constraints for table `notifications`
--
ALTER TABLE `notifications`
  ADD CONSTRAINT `notifications_user_id_fkey` FOREIGN KEY (`user_id`) REFERENCES `users` (`id`) ON DELETE CASCADE ON UPDATE CASCADE;

--
-- Constraints for table `nutritional_info`
--
ALTER TABLE `nutritional_info`
  ADD CONSTRAINT `nutritional_info_recipe_id_fkey` FOREIGN KEY (`recipe_id`) REFERENCES `recipes` (`id`) ON DELETE CASCADE ON UPDATE CASCADE;

--
-- Constraints for table `payments`
--
ALTER TABLE `payments`
  ADD CONSTRAINT `fk_payments_plan` FOREIGN KEY (`plan_id`) REFERENCES `subscription_plans` (`id`) ON DELETE SET NULL,
  ADD CONSTRAINT `fk_payments_user` FOREIGN KEY (`user_id`) REFERENCES `users` (`id`) ON DELETE CASCADE;

--
-- Constraints for table `recipes`
--
ALTER TABLE `recipes`
  ADD CONSTRAINT `recipes_user_id_fkey` FOREIGN KEY (`user_id`) REFERENCES `users` (`id`) ON DELETE CASCADE ON UPDATE CASCADE;

--
-- Constraints for table `recipe_categories`
--
ALTER TABLE `recipe_categories`
  ADD CONSTRAINT `recipe_categories_category_id_fkey` FOREIGN KEY (`category_id`) REFERENCES `categories` (`id`) ON DELETE CASCADE ON UPDATE CASCADE,
  ADD CONSTRAINT `recipe_categories_recipe_id_fkey` FOREIGN KEY (`recipe_id`) REFERENCES `recipes` (`id`) ON DELETE CASCADE ON UPDATE CASCADE;

--
-- Constraints for table `recipe_cuisines`
--
ALTER TABLE `recipe_cuisines`
  ADD CONSTRAINT `recipe_cuisines_cuisine_id_fkey` FOREIGN KEY (`cuisine_id`) REFERENCES `cuisines` (`id`) ON DELETE CASCADE ON UPDATE CASCADE,
  ADD CONSTRAINT `recipe_cuisines_recipe_id_fkey` FOREIGN KEY (`recipe_id`) REFERENCES `recipes` (`id`) ON DELETE CASCADE ON UPDATE CASCADE;

--
-- Constraints for table `recipe_ingredients`
--
ALTER TABLE `recipe_ingredients`
  ADD CONSTRAINT `recipe_ingredients_ingredient_id_fkey` FOREIGN KEY (`ingredient_id`) REFERENCES `ingredients` (`id`) ON DELETE SET NULL ON UPDATE CASCADE,
  ADD CONSTRAINT `recipe_ingredients_recipe_id_fkey` FOREIGN KEY (`recipe_id`) REFERENCES `recipes` (`id`) ON DELETE CASCADE ON UPDATE CASCADE;

--
-- Constraints for table `recipe_tags`
--
ALTER TABLE `recipe_tags`
  ADD CONSTRAINT `recipe_tags_recipe_id_fkey` FOREIGN KEY (`recipe_id`) REFERENCES `recipes` (`id`) ON DELETE CASCADE ON UPDATE CASCADE,
  ADD CONSTRAINT `recipe_tags_tag_id_fkey` FOREIGN KEY (`tag_id`) REFERENCES `tags` (`id`) ON DELETE CASCADE ON UPDATE CASCADE;

--
-- Constraints for table `reports`
--
ALTER TABLE `reports`
  ADD CONSTRAINT `reports_ibfk_1` FOREIGN KEY (`reporter_id`) REFERENCES `users` (`id`) ON DELETE CASCADE,
  ADD CONSTRAINT `reports_ibfk_2` FOREIGN KEY (`reviewed_by`) REFERENCES `users` (`id`) ON DELETE SET NULL;

--
-- Constraints for table `reviews`
--
ALTER TABLE `reviews`
  ADD CONSTRAINT `reviews_recipe_id_fkey` FOREIGN KEY (`recipe_id`) REFERENCES `recipes` (`id`) ON DELETE CASCADE ON UPDATE CASCADE,
  ADD CONSTRAINT `reviews_user_id_fkey` FOREIGN KEY (`user_id`) REFERENCES `users` (`id`) ON DELETE CASCADE ON UPDATE CASCADE;

--
-- Constraints for table `sessions`
--
ALTER TABLE `sessions`
  ADD CONSTRAINT `sessions_ibfk_1` FOREIGN KEY (`user_id`) REFERENCES `users` (`id`) ON DELETE CASCADE;

--
-- Constraints for table `shopping_lists`
--
ALTER TABLE `shopping_lists`
  ADD CONSTRAINT `shopping_lists_user_id_fkey` FOREIGN KEY (`user_id`) REFERENCES `users` (`id`) ON DELETE CASCADE ON UPDATE CASCADE;

--
-- Constraints for table `shopping_list_items`
--
ALTER TABLE `shopping_list_items`
  ADD CONSTRAINT `shopping_list_items_ingredient_id_fkey` FOREIGN KEY (`ingredient_id`) REFERENCES `ingredients` (`id`) ON DELETE SET NULL ON UPDATE CASCADE,
  ADD CONSTRAINT `shopping_list_items_shopping_list_id_fkey` FOREIGN KEY (`shopping_list_id`) REFERENCES `shopping_lists` (`id`) ON DELETE CASCADE ON UPDATE CASCADE;

--
-- Constraints for table `subscriptions`
--
ALTER TABLE `subscriptions`
  ADD CONSTRAINT `fk_subscription_plan` FOREIGN KEY (`plan_id`) REFERENCES `subscription_plans` (`id`),
  ADD CONSTRAINT `fk_subscription_user` FOREIGN KEY (`user_id`) REFERENCES `users` (`id`) ON DELETE CASCADE;

--
-- Constraints for table `subscription_invoices`
--
ALTER TABLE `subscription_invoices`
  ADD CONSTRAINT `subscription_invoices_ibfk_1` FOREIGN KEY (`subscription_id`) REFERENCES `subscriptions` (`id`) ON DELETE CASCADE,
  ADD CONSTRAINT `subscription_invoices_ibfk_2` FOREIGN KEY (`user_id`) REFERENCES `users` (`id`) ON DELETE CASCADE;

--
-- Constraints for table `subscription_payments`
--
ALTER TABLE `subscription_payments`
  ADD CONSTRAINT `fk_payment_subscription` FOREIGN KEY (`subscription_id`) REFERENCES `subscriptions` (`id`) ON DELETE CASCADE;

--
-- Constraints for table `users`
--
ALTER TABLE `users`
  ADD CONSTRAINT `fk_user_current_subscription` FOREIGN KEY (`current_subscription_id`) REFERENCES `subscriptions` (`id`) ON DELETE SET NULL;

--
-- Constraints for table `user_auth_providers`
--
ALTER TABLE `user_auth_providers`
  ADD CONSTRAINT `user_auth_providers_user_id_fkey` FOREIGN KEY (`user_id`) REFERENCES `users` (`id`) ON DELETE CASCADE ON UPDATE CASCADE;

--
-- Constraints for table `user_favorites`
--
ALTER TABLE `user_favorites`
  ADD CONSTRAINT `user_favorites_recipe_id_fkey` FOREIGN KEY (`recipe_id`) REFERENCES `recipes` (`id`) ON DELETE CASCADE ON UPDATE CASCADE,
  ADD CONSTRAINT `user_favorites_user_id_fkey` FOREIGN KEY (`user_id`) REFERENCES `users` (`id`) ON DELETE CASCADE ON UPDATE CASCADE;

--
-- Constraints for table `user_followers`
--
ALTER TABLE `user_followers`
  ADD CONSTRAINT `user_followers_follower_id_fkey` FOREIGN KEY (`follower_id`) REFERENCES `users` (`id`) ON DELETE CASCADE ON UPDATE CASCADE,
  ADD CONSTRAINT `user_followers_following_id_fkey` FOREIGN KEY (`following_id`) REFERENCES `users` (`id`) ON DELETE CASCADE ON UPDATE CASCADE;

--
-- Constraints for table `user_profiles`
--
ALTER TABLE `user_profiles`
  ADD CONSTRAINT `user_profiles_user_id_fkey` FOREIGN KEY (`user_id`) REFERENCES `users` (`id`) ON DELETE CASCADE ON UPDATE CASCADE;

--
-- Constraints for table `user_subscriptions`
--
ALTER TABLE `user_subscriptions`
  ADD CONSTRAINT `user_subscriptions_ibfk_1` FOREIGN KEY (`user_id`) REFERENCES `users` (`id`) ON DELETE CASCADE,
  ADD CONSTRAINT `user_subscriptions_ibfk_2` FOREIGN KEY (`plan_id`) REFERENCES `subscription_plans` (`id`);

--
-- Constraints for table `user_subscription_features`
--
ALTER TABLE `user_subscription_features`
  ADD CONSTRAINT `fk_feature_user` FOREIGN KEY (`user_id`) REFERENCES `users` (`id`) ON DELETE CASCADE;

--
-- Constraints for table `verification_requests`
--
ALTER TABLE `verification_requests`
  ADD CONSTRAINT `verification_requests_ibfk_1` FOREIGN KEY (`user_id`) REFERENCES `users` (`id`) ON DELETE CASCADE,
  ADD CONSTRAINT `verification_requests_ibfk_2` FOREIGN KEY (`reviewed_by`) REFERENCES `users` (`id`) ON DELETE SET NULL;
COMMIT;

/*!40101 SET CHARACTER_SET_CLIENT=@OLD_CHARACTER_SET_CLIENT */;
/*!40101 SET CHARACTER_SET_RESULTS=@OLD_CHARACTER_SET_RESULTS */;
/*!40101 SET COLLATION_CONNECTION=@OLD_COLLATION_CONNECTION */;
